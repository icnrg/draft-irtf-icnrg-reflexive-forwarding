<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Reflexive Forwarding for CCNx and NDN Protocols</title>
<meta content="Dave Oran" name="author">
<meta content="Dirk Kutscher" name="author">
<meta content="Hitoshi Asaeda" name="author">
<meta content="
       
 Current Information-Centric Networking protocols such as CCNx
 and NDN have a wide range of useful applications in content
 retrieval and other scenarios that depend only on a robust
 two-way exchange in the form of a request and response
 (represented by an  Interest-Data exchange  in the case
 of the two protocols noted above). A number of important
 applications however, require placing large amounts of data in
 the Interest message, and/or more than one two-way
 handshake. While these can be accomplished using independent
 Interest-Data exchanges by reversing the roles of consumer and
 producer, such approaches can be both clumsy for applications
 and problematic from a state management, congestion control,
 or security standpoint. This specification proposes a
  Reflexive Forwarding  extension to the CCNx and NDN
 protocol architectures that eliminates the problems inherent
 in using independent Interest-Data exchanges for such
 applications. It updates RFC8569 and RFC8609.
       
    " name="description">
<meta content="xml2rfc 3.23.2" name="generator">
<meta content="ICN" name="keyword">
<meta content="Information-centric Networking" name="keyword">
<meta content="forwarding" name="keyword">
<meta content="draft-irtf-icnrg-reflexive-forwarding-00" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.23.2
    Python 3.9.10
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.0
    platformdirs 3.7.0
    pycountry 22.3.5
    pydyf 0.2.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 60.5.0
    wcwidth 0.2.5
    weasyprint 56.1
-->
<link href="draft-irtf-icnrg-reflexive-forwarding.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body class="xml2rfc">
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">ICN Reflexive Forwarding</td>
<td class="right">October 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Oran, et al.</td>
<td class="center">Expires 20 April 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">ICNRG</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-irtf-icnrg-reflexive-forwarding-00</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc8569" class="eref">8569</a>, <a href="https://www.rfc-editor.org/rfc/rfc8609" class="eref">8609</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-10-17" class="published">17 October 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Experimental</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-04-20">20 April 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Oran</div>
<div class="org">Network Systems Research and Design</div>
</div>
<div class="author">
      <div class="author-name">D. Kutscher</div>
<div class="org">HKUST(GZ)</div>
</div>
<div class="author">
      <div class="author-name">H. Asaeda</div>
<div class="org">NICT</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Reflexive Forwarding for CCNx and NDN Protocols</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
 Current Information-Centric Networking protocols such as CCNx
 and NDN have a wide range of useful applications in content
 retrieval and other scenarios that depend only on a robust
 two-way exchange in the form of a request and response
 (represented by an <em>Interest-Data exchange</em> in the case
 of the two protocols noted above). A number of important
 applications however, require placing large amounts of data in
 the Interest message, and/or more than one two-way
 handshake. While these can be accomplished using independent
 Interest-Data exchanges by reversing the roles of consumer and
 producer, such approaches can be both clumsy for applications
 and problematic from a state management, congestion control,
 or security standpoint. This specification proposes a
 <em>Reflexive Forwarding</em> extension to the CCNx and NDN
 protocol architectures that eliminates the problems inherent
 in using independent Interest-Data exchanges for such
 applications. It updates RFC8569 and RFC8609.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 20 April 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-problems-with-pushing-data" class="internal xref">Problems with pushing data</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-problems-with-utilizing-ind" class="internal xref">Problems with utilizing independent exchanges</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-definitions" class="internal xref">Definitions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-overview-of-the-reflexive-f" class="internal xref">Overview of the Reflexive Forwarding design</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-detailed-specification-of-r" class="internal xref">Detailed Specification of Reflexive Forwarding</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-generic-forwarder-design" class="internal xref">Generic Forwarder Design</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-interaction-flow-for-reflex" class="internal xref">Interaction Flow for Reflexive Forwarding: An Example</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-consumer-operation" class="internal xref">Consumer Operation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-naming-of-reflexive-interes" class="internal xref">Naming of Reflexive Interests</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-producer-operation" class="internal xref">Producer Operation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-forwarder-operation" class="internal xref">Forwarder Operation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6.2.1">
                    <p id="section-toc.1-1.4.2.6.2.1.1"><a href="#section-4.6.1" class="auto internal xref">4.6.1</a>.  <a href="#name-forwarder-algorithms-in-pse" class="internal xref">Forwarder algorithms in pseudocode</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6.2.1.2.1">
                        <p id="section-toc.1-1.4.2.6.2.1.2.1.1"><a href="#section-4.6.1.1" class="auto internal xref">4.6.1.1</a>.  <a href="#name-processing-of-a-trigger-int" class="internal xref">Processing of a Trigger Interest containing a Reflexive Name Prefix TLV</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6.2.1.2.2">
                        <p id="section-toc.1-1.4.2.6.2.1.2.2.1"><a href="#section-4.6.1.2" class="auto internal xref">4.6.1.2</a>.  <a href="#name-processing-of-a-reflexive-i" class="internal xref">Processing of a Reflexive Interest</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="auto internal xref">4.7</a>.  <a href="#name-state-coupling-between-prod" class="internal xref">State coupling between producer and consumer</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-use-cases-for-reflexive-int" class="internal xref">Use cases for Reflexive Interests</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-achieving-remote-method-inv" class="internal xref">Achieving Remote Method Invocation with Reflexive Interests</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-restful-web-interactions" class="internal xref">RESTful Web Interactions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-achieving-simple-data-pull-" class="internal xref">Achieving simple data pull from consumers with reflexive Interests</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-implementation-consideratio" class="internal xref">Implementation Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-forwarder-implementation-co" class="internal xref">Forwarder implementation considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="auto internal xref">6.1.1</a>.  <a href="#name-interactions-with-input-pro" class="internal xref">Interactions with Input Processing of Interest and Data packets</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="auto internal xref">6.1.2</a>.  <a href="#name-interactions-with-interest-" class="internal xref">Interactions with Interest Lifetime</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.3">
                    <p id="section-toc.1-1.6.2.1.2.3.1"><a href="#section-6.1.3" class="auto internal xref">6.1.3</a>.  <a href="#name-interactions-with-interest-a" class="internal xref">Interactions with Interest aggregation and multi-path/multi-destination forwarding</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-consumer-implementation-con" class="internal xref">Consumer Implementation Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="auto internal xref">6.2.1</a>.  <a href="#name-data-objects-returned-by-th" class="internal xref">Data objects returned by the consumer to reflexive name Interests arriving from a producer</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="auto internal xref">6.2.2</a>.  <a href="#name-terminating-unwanted-reflex" class="internal xref">Terminating unwanted reflexive Interest exchanges</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.3">
                    <p id="section-toc.1-1.6.2.2.2.3.1"><a href="#section-6.2.3" class="auto internal xref">6.2.3</a>.  <a href="#name-interactions-with-caching" class="internal xref">Interactions with caching</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-producer-implementation-con" class="internal xref">Producer Implementation Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-operational-considerations" class="internal xref">Operational Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-mapping-to-ccnx-and-ndn-pac" class="internal xref">Mapping to CCNx and NDN packet encodings</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-packet-encoding-for-ccnx" class="internal xref">Packet encoding for CCNx</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-packet-encoding-for-ndn" class="internal xref">Packet encoding for NDN</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.1">
                    <p id="section-toc.1-1.8.2.2.2.1.1"><a href="#section-8.2.1" class="auto internal xref">8.2.1</a>.  <a href="#name-reflexive-name-component-ty" class="internal xref">Reflexive Name Component Type</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.2">
                    <p id="section-toc.1-1.8.2.2.2.2.1"><a href="#section-8.2.2" class="auto internal xref">8.2.2</a>.  <a href="#name-reflexive-name-prefix-tlv-2" class="internal xref">Reflexive Name Prefix TLV</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-ccnx-name-segment-type-regi" class="internal xref">CCNx Name Segment Type Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-collisions-of-reflexive-int" class="internal xref">Collisions of reflexive Interest names</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-additional-resource-pressur" class="internal xref">Additional resource pressure on PIT and FIB</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="auto internal xref">10.3</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-alternative-designs-conside" class="internal xref">Alternative Designs Considered</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-handling-reflexive-interest" class="internal xref">Handling reflexive interests using dynamic FIB entries</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1.2.1">
                    <p id="section-toc.1-1.13.2.1.2.1.1"><a href="#appendix-A.1.1" class="auto internal xref">A.1.1</a>.  <a href="#name-design-complexities-and-per" class="internal xref">Design complexities and performance issues with FIB-based design</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1.2.2">
                    <p id="section-toc.1-1.13.2.1.2.2.1"><a href="#appendix-A.1.2" class="auto internal xref">A.1.2</a>.  <a href="#name-interactions-between-fib-ba" class="internal xref">Interactions between FIB-based design and Interest Lifetime</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-reflexive-forwarding-using-" class="internal xref">Reflexive forwarding using Path Steering</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-ndn-implementation" class="internal xref">NDN Implementation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-reflexive-name-segment-2" class="internal xref">Reflexive Name Segment</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-processing-reflexive-intere" class="internal xref">Processing Reflexive Interests&gt;</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
    Current ICN protocols such as <span><a href="#RFC8569" class="internal xref">CCNx</a> [<a href="#RFC8569" class="cite xref">RFC8569</a>]</span>
    and <span><a href="#NDN" class="internal xref">NDN</a> [<a href="#NDN" class="cite xref">NDN</a>]</span> have a wide range of useful
    applications in content retrieval and other scenarios that depend
    only on a robust two-way exchange in the form of a request and
    response. These ICN architectures use the terms "consumer" and
    "producer" for the respective roles of the requester and the
    responder, and the protocols directly capture the mechanics of the
    two-way exchange through the "Interest message" carrying the
    request, and the "Data message" carrying the response. Through
    these constructs, the protocols are heavily biased toward a pure
    <em>pull-based</em> interaction model where requests are small
    (carrying little or no user-supplied data other than the name of
    the requested data object), and responses are relatively large -
    up to an architecture-defined maximum transmission unit (MTU) on
    the order of kilobytes or tens of kilobytes.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
    A number of important applications however require interaction
    models more complex than individual request/response interactions
    in the same direction (i.e. between the same consumer and one or
    more producers). Among these we identify three important classes
    which are the target of the proposed enhancements defined in this
    specification. These are described in the following paragraphs.<a href="#section-1-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1-3">
        <dt id="section-1-3.1"><strong>Remote Method Invocation (RMI, aka RPC):</strong></dt>
        <dd style="margin-left: 1.5em" id="section-1-3.2">
      When invoking a remote method, it is common for the method to
      require arguments supplied by the caller. In conventional TCP/IP
      style protocols like CORBA or HTTP "Post", these are pushed to
      the server as part of the message or messages that comprise the
      request. In ICN-style protocols there is an unattractive choice
      between inflating the request initiation with pushed arguments,
      or arranging to have one or more independent request/response pairs
      in the opposite direction for the server to fetch the
      arguments. Both of these approaches have substantial
      disadvantages. Recently, a viable alternative emerged through
      the work on <span><a href="#Krol2018" class="internal xref">RICE</a> [<a href="#Krol2018" class="cite xref">Krol2018</a>]</span> which pioneered
      the main design elements proposed in this specification.<a href="#section-1-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.3"><strong>Phone-Home scenario:</strong></dt>
        <dd style="margin-left: 1.5em" id="section-1-3.4">
      Applications in sensing, Internet-of-things (IoT) and other
      types where data is produced unpredictably and needs to be
      <em>pushed</em> somewhere create a conundrum for the pure
      pull-based architectures considered here. If instead one eschews
      relaxing the size asymmetry between requests and responses, some
      additional protocol machinery is needed. Earlier efforts in the
      ICN community have recognized this issue and designed methods to
      provoke a cooperating element to issue a request to return the
      data the originator desires to push, essentially "phoning home"
      to get the responder to fetch the data. One that has been
      explored to some extent is the <em>Interest-Interest-Data</em>
      exchange <span>[<a href="#Carzaniga2011" class="cite xref">Carzaniga2011</a>]</span>, where an Interest is
      sent containing the desired request as encapsulated
      data. CCNx-1.0 Bidirectional Streams <span>[<a href="#Mosko2017" class="cite xref">Mosko2017</a>]</span>
      are also based on a scheme where an Interest is used to signal a
      name prefix that a consumer has registered for receiving
      Interests from a peer in a bidirectional streaming session.<a href="#section-1-3.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.5"><strong>Peer state synchronization:</strong></dt>
        <dd style="margin-left: 1.5em" id="section-1-3.6">
      A large class of applications, typified by those built on top of
      reliable order-preserving transport protocols, require
      initial state synchronization between the peers. This is
      accomplished with a three-way (or longer) handshake, since
      employing a two-way handshake as provided in the existing NDN
      and CCNx protocols exposes a number of well-know hazards, such
      as <em>half-open connections</em>. When attempted for
      security-related operations such as key exchange, additional
      hazards such as <em>man-in-the-middle</em> attacks become
      trivial to mount. Existing alternatives, similar to those used
      in the two examples above, instead utilize either overlapping
      Interest-Data exchanges in opposite directions (resulting in a
      four-way handshake) or by adding initialization data to the
      initial request and employing an Interest-Interest-Data protocol
      extension as noted in the Phone-home scenarios above.<a href="#section-1-3.6" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-1-4">
    All of the above application interaction models present
    interesting challenges, as neither relaxing the architecture to
    support pushing large amounts of data, nor introducing substantial
    complexities through multiple independent Interest-Data exchanges
    is an attractive approach. The following subsections provide
    further background and justification for why push and/or
    independent exchanges are problematical.<a href="#section-1-4" class="pilcrow">¶</a></p>
<div id="push-problems">
<section id="section-1.1">
        <h3 id="name-problems-with-pushing-data">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-problems-with-pushing-data" class="section-name selfRef">Problems with pushing data</a>
        </h3>
<p id="section-1.1-1">
    There are two substantial problems with the simple approach of
    just allowing arbitrary amounts of data to be included with
    requests. These are:<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.1-2">
     <li id="section-1.1-2.1">
       In ICN protocols such as NDN and CCNx, Interest messages are intended to be small,
       on the order the size of a TCP ACK, as opposed to the size of a
       TCP data segment. This is because the hop-by-hop congestion
       control and forwarder state management requires Interest
       messages to be buffered in expectation of returning data, and
       possibly retransmitted hop-by-hop as opposed to end-to-end. In
       addition, the need to create and manage state on a per-Interest
       basis is substantially complicated if requests in Interest
       messages are larger than a Path MTU (PMTU) and need to be
       fragmented hop-by-hop.<a href="#section-1.1-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-1.1-2.2">
       If the payload data of a request is used for invoking a
       computation (as in the RMI case described above)
       then substantial bandwidth can be wasted if the computation is
       either refused or abandoned for any number of reasons,
       including the requestor failing an authorization check, or the
       responder not having sufficient resources to execute the
       associated computation.<a href="#section-1.1-2.2" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-1.1-3">
     These problems also exist in pure datagram transport protocols
     such as those used for legacy RMI applications like <span><a href="#RFC7530" class="internal xref">NFS</a> [<a href="#RFC7530" class="cite xref">RFC7530</a>]</span>. More usual are application protocols
     like HTTP(s) which rely on the TCP or QUIC 3-way handshake to
     establish a session and then have congestion control and
     segmentation provided as part of the transport protocol, further
     allowing sessions to be rejected before large amounts of data are
     transmitted or significant computational resources expended.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="independent-exchange-problems">
<section id="section-1.2">
        <h3 id="name-problems-with-utilizing-ind">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-problems-with-utilizing-ind" class="section-name selfRef">Problems with utilizing independent exchanges</a>
        </h3>
<p id="section-1.2-1">
    In order to either complete a three-way handshake, or fetch data
    via a pull from the original requestor, the role of consumer and
    producer need to be reversed and an Interest/Data exchange
    initiated in the direction opposite of the initiating
    exchange. When done with an independent Interest/Data request and
    response, a number of complications ensue. Among them are:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.2-2">
    <li id="section-1.2-2.1">
<div id="routable-name-prefix">
      The originating consumer needs to have a routable name prefix
      that can be used for the exchange. This means the consumer must
      arrange to have its name prefix propagated in the ICN routing system
      with sufficient reach that the producer issuing the interest can
      be assured it is routed appropriately. While some consumers are
      generally online and act as application servers, justifying the
      maintenance of this routing information, many do not. Further,
      in mobile environments, a pure consumer that does not need to
      have a routable name prefix can benefit from the inherent
      consumer mobility support in the CCNx and NDN protocols. By
      requiring a routable name prefix, extra mobile routing machinery
      is needed, such as that proposed in <span><a href="#Zhang2018" class="internal xref">KITE</a> [<a href="#Zhang2018" class="cite xref">Zhang2018</a>]</span> or <span><a href="#Auge2018" class="internal xref">MAPME</a> [<a href="#Auge2018" class="cite xref">Auge2018</a>]</span>.<a href="#routable-name-prefix" class="pilcrow">¶</a>
</div>
          </li>
<li id="section-1.2-2.2">
<div id="reflection-attack">
      The consumer name prefix in <span><a href="#routable-name-prefix" class="internal xref">item</a> (<a href="#routable-name-prefix" class="auto internal xref">1</a>)</span> above must be communicated to the
      producer as a payload, name suffix, or other field of the
      initiating Interest message. Since this name in its entirety is
      chosen by the consumer, it is highly problematic from a security
      standpoint, as it can recruit the producer to mount a reflection
      attack against the consumer's chosen victim.<a href="#reflection-attack" class="pilcrow">¶</a>
</div>
          </li>
<li id="section-1.2-2.3">
      The correlation between the exchanges in opposite directions
      must be maintained by both the consumer and the producer as
      independent state, as opposed to being architecturally tied
      together as would be the case with a conventional 3-way
      handshake finite state machine. While this can of course be
      accomplished with care by both parties, experience has shown
      that it is error prone (for example see the checkered history of
      interactions between the <span><a href="#RFC3261" class="internal xref">SIP</a> [<a href="#RFC3261" class="cite xref">RFC3261</a>]</span> and
      <span><a href="#RFC6337" class="internal xref">SDP Offer-Answer</a> [<a href="#RFC6337" class="cite xref">RFC6337</a>]</span>) protocols. When employed
      as the wrapper for a key management protocol such as with <span><a href="#RFC8446" class="internal xref">TLS</a> [<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> state management errors can be
      catastrophic for security.<a href="#section-1.2-2.3" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="definitions">
<section id="section-2.1">
        <h3 id="name-definitions">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-definitions" class="section-name selfRef">Definitions</a>
        </h3>
<p id="section-2.1-1">For general ICN-related terms, we adopt the terms defined in <span>[<a href="#RFC8793" class="cite xref">RFC8793</a>]</span>. For CCNx-specific terms, we use the terms defined in <span>[<a href="#RFC8569" class="cite xref">RFC8569</a>]</span> and <span>[<a href="#RFC8609" class="cite xref">RFC8609</a>]</span>. This specification defines the following additional terms:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.1-2">
          <dt id="section-2.1-2.1">
<strong>Reflexive Interest</strong> (RI)</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.2">An interest message sent from a producer back towards a consumer to fetch data needed to satisfy the original interest.<a href="#section-2.1-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.3">
<strong>Trigger Interest</strong> (TI)</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.4">An interest message sent from a consumer to a producer to trigger one or more Reflexive Interests sent by the producer.<a href="#section-2.1-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.5"><strong>Reflexive Name Segment</strong></dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.6">A high-order typed name segment which identifies an Interest as being a Reflexive Interest instead of a normal Interest.<a href="#section-2.1-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.7"><strong>Reflexive Name Prefix (RNP) TLV</strong></dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.8">An Interest message indicating to a producer that it may fetch data from the sending consumer by issuing one or more corresponding Reflexive Interests. It consists of a Name prefix whose high-order is a Reflexive Name Segment as defined above.<a href="#section-2.1-2.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="design-overview">
<section id="section-3">
      <h2 id="name-overview-of-the-reflexive-f">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-overview-of-the-reflexive-f" class="section-name selfRef">Overview of the Reflexive Forwarding design</a>
      </h2>
<p id="section-3-1">
  This specification defines a <em>Reflexive Forwarding</em> extension
  to CCNx and NDN that avoids the problems enumerated in Sections
  <a href="#push-problems" class="auto internal xref">1.1</a> and <a href="#independent-exchange-problems" class="auto internal xref">1.2</a>. It
  straightforwardly exploits the hop-by-hop state and symmetric
  routing properties of the current protocols.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">
  <a href="#forwarder-data-structures" class="auto internal xref">Figure 1</a> below illustrates a
  canonical NDN/CCNx forwarder with its conceptual data structures of
  the Content Store (CS), Pending Interest Table (PIT) and Forwarding
  Information Base (FIB). The key observation involves the relation
  between the PIT and the FIB. Upon arrival of an Interest, a PIT
  entry is created which contains state recording the incoming
  interface on which the Interest was received on. If the Interest is
  not immediately satisfied by cached data in the CS, the forwarder
  looks up the name in the FIB to ascertain the <em>next-hop</em> to
  propagate the Interest onward upstream toward the named
  producer. Therefore, a chain of forwarding state is established
  during Interest forwarding that couples the PIT entries of the chain
  of forwarders together conceptually as <em>breadcrumbs</em>. These
  are used to forward the returning Data Message over the inverse path
  through the chain of forwarders until the Data message arrives at
  the originating consumer. The state in the PITs is <em>unwound</em>
  by destroying it as each PIT entry is <em>satisfied</em>. This
  behavior is <strong>critical</strong> to the feasibility of the
  reflexive forwarding design we propose.<a href="#section-3-2" class="pilcrow">¶</a></p>
<span id="name-icn-forwarder-structure"></span><div id="forwarder-data-structures">
<figure id="figure-1">
        <div class="alignLeft art-ascii-art art-text artwork" id="section-3-3.1">
<pre>
 +-----------------------------------------------------------------+
 |                                                      ICN Node   |
 | Send data to all                                     ========   |
 | interfaces that                                                 |
 | requested it                                                    |
 |                  YES +------------------+                       |
&lt;-----------------------| Pending Interest |  &lt;---------------------
 |              |       |    Table (PIT)   |               Data    |
 |              |       +------------------+  1) Find     (Signed) |
 |              | 2) Save         |              Name              |
 |              V    Data         | NO            in               |
 |   +---------------+            |              PIT?              |
 |   | Content Store |            |                                |
 |   |      (CS)     |            |                                |
 |   +---------------+            |                                |
 |                                |                                |
 |                                V                                |
 |                             Drop Data                           |
 |                                                                 |
 +-----------------------------------------------------------------+
</pre>
</div>
<div class="alignLeft art-ascii-art art-text artwork" id="section-3-3.2">
<pre>
 +-----------------------------------------------------------------+
 |                                                      ICN Node   |
 |                                                      ========   |
 |                                                                 |
 |                                           +====================+|
 |                                           |Forwarding Strategy ||
 |                                           +====================+|
 |                                                                 |
 |   1) Find name          2) Matching        3) Find matching     |
 |        in CS?              name in PIT?       entry in FIB?     |
 |                    NO                   NO                   YES|
 |  +---------------+   +----------------+   +-------------------+ |
 |  | Content Store |   |   Pending      |   |  Forwarding       | |
---&gt;|      (CS)     |--&gt;|   Interest     |--&gt;|  Information Base |--&gt;
 |  |               |   |   Table (PIT)  |   |     ( FIB)        | |
 |  +---------------+   +----------------+   +-------------------+ |
 | Return   | YES           YES | NO               NO |            |
 |  Data    |          Add      |   Add               |  Drop      |
 |          |          Incoming |   new               |   or       |
 |   &lt;------+          Itf.     |   Interest          |  NACK      |
 |                              V                     V            |
 |                                                                 |
 +-----------------------------------------------------------------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-icn-forwarder-structure" class="selfRef">ICN forwarder structure</a>
        </figcaption></figure>
</div>
<p id="section-3-4">
   Given the above forwarding properties for Interests, it
   should be clear that while an Interest is outstanding and
   ultimately arrives at a producer who can respond to it,
   there is sufficient state in the chain of forwarders to
   route not just a returning Data message, but potentially
   another Interest directed through the inverse path to the
   unique consumer who issued the original Interest. (<a href="#interest-aggregation" class="auto internal xref">Section 6.1.3</a> describes how Interest
   aggregation of requests to the same target name from multiple consumers
   interacts with this scheme.) The key question
   therefore is how to access this state in a way that it can
   be used to forward Interests.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">
   In order to achieve this <em>Reflexive Interest</em>
   forwarding on the inverse path recorded in the PIT of each
   forwarder, we need a few critical design elements:<a href="#section-3-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3-6">
   <li id="section-3-6.1">
     The Reflexive Interest needs to have a <em>Name</em>. This name is
     what the originating consumer will use to match against
     the Data object (or multiple Data objects — more on this
     later) that the producer may request by issuing the
     Reflexive Interest. This cannot be just any name, but
     needs to essentially name the state already recorded in
     the PIT and not allow the consumer to manufacture an
     arbitrary name and mount a reflection attack as pointed
     out in <a href="#reflection-attack" class="auto internal xref">Section 1.2, Paragraph 2, Item 2</a>.<a href="#section-3-6.1" class="pilcrow">¶</a>
</li>
        <li id="section-3-6.2">
<div id="interest-fwd-requirements">
     Each forwarder along the inverse path from producer to
     consumer must be able to forward the Reflexive Interest
     towards the direction of the Consumer, without relying
     on global routing information, as the Reflexive
     Name Prefixes are only valid while the originating Interest/Data exchange
     state is present at the forwarders. Essential to this operation is the ability to
     access the PIT entry associated with the original Interest
     message, which triggers the Reflexive Interest, since that contains the state necessary to
     identify the ingress face of the original Interest, which
     is the unique (modulo aggregation) output face over which the Reflexive
     Interest needs to be forwarded. The Name assigned by the
     consumer for Reflexive Name Prefix in theory is adequate
     to the task, but entails an expensive and complicated
     lookup procedure.<a href="#interest-fwd-requirements" class="pilcrow">¶</a>
</div>
        </li>
<li id="section-3-6.3">
     There has to be coupling of the state between the
     originating Interest-Data exchange and the enclosed
     Reflexive Interest-Data exchange at both the consumer and
     the producer. In our design, this is accomplished by the
     way Reflexive Interest names are chosen.<a href="#section-3-6.3" class="pilcrow">¶</a>
</li>
      </ol>
</section>
</div>
<div id="detailed-specification">
<section id="section-4">
      <h2 id="name-detailed-specification-of-r">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-detailed-specification-of-r" class="section-name selfRef">Detailed Specification of Reflexive Forwarding</a>
      </h2>
<p id="section-4-1">The following sections provide the normative details on each of these design elements.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="generic_spec">
<section id="section-4.1">
        <h3 id="name-generic-forwarder-design">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-generic-forwarder-design" class="section-name selfRef">Generic Forwarder Design</a>
        </h3>
<p id="section-4.1-1">The following describes the operation of a CCNx or NDN forwarder enhanced to accommodate reflexive forwarding via Trigger Interests, Reflexive Interests, and Reflexive Data messages. This description likely adequate for most implementation approaches. However, there are possible performance bottlenecks for reflexive forwarding that employ highly parallel forwarding schemes using multi-core server systems. Such systems may use <em>PIT Sharding</em> across cores, and therefore benefit from additional optional protocol enhancements, such as the "PIT Token" protocol elements pioneered in <span>[<a href="#Shi2020" class="cite xref">Shi2020</a>]</span>. Alternatively, techniques such as those employed by the Cefore <span>[<a href="#Asaeda2019" class="cite xref">Asaeda2019</a>]</span><span>[<a href="#Cefore" class="cite xref">Cefore</a>]</span> forwarder from NICT may be employed.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CCNx_spec">
<section id="section-4.2">
        <h3 id="name-interaction-flow-for-reflex">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-interaction-flow-for-reflex" class="section-name selfRef">Interaction Flow for Reflexive Forwarding: An Example</a>
        </h3>
<p id="section-4.2-1">Based on the implementations approach in Cefore <span>[<a href="#Asaeda2019" class="cite xref">Asaeda2019</a>]</span><span>[<a href="#Cefore" class="cite xref">Cefore</a>]</span>, an example of the overall interaction flow for reflexive forwarding for CCNx is described below and illustrated in <a href="#overall-message-flow-ccnx" class="auto internal xref">Figure 2</a>.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">Forwarder operation for CCNx is slightly changed in the following respects when supporting Reflexive Interests. When a forwarder receives a Trigger Interest (TI) that will be sent toward the producer, the forwarder creates two PIT entries; (1) a regular PIT entry for TI (TI-PIT, hereafter) that consists of the name of the Name TLV in TI, downstream face (i.e., face from which the TI is received), and upstream face(s) (i.e., face(s) from which the TI is/are forwarded), and (2) a tentative PIT entry for a Reflexive Interest (RI) (RI-PIT(dummy), hereafter) that includes Reflexive Name Prefix (RNP), downstream face (i.e., face(s) from which the TI is/are forwarded), and upstream face (i.e., face from which the TI is received). RI-PIT(dummy) is created whenever TI is received. However, RI-PIT(dummy) is not used for packet forwarding; it is only referred to create the actual PIT entry for RI (RI-PIT, hereafter). When a forwarder receives RI, it creates RI-PIT by copying the downstream and upstream faces from the RI-PIT(dummy) with the same RNP.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<span id="name-overview-of-message-flow-in"></span><div id="overall-message-flow-ccnx">
<figure id="figure-2">
          <div class="alignCenter art-text artwork" id="section-4.2-3.1">
<pre>
+----------+           +-----------+             +----------+
| Consumer |           | Forwarder |             | Producer |
+----------+           +-----------+             +----------+
    |                        |                          |
    | TI                     |                          |
    |-----------------------&gt;|                          |
    |    +-----------------\ |                          |
    |    | record fullname |-|                          |
    |    | in TI-PIT(TI)   | |                          |
    |    +-----------------+ |                          |
    |                        | +--------------------\   |
    |                        |-| add RNP to         |   |
    |                        | | RI-PIT(dummy)(RI)  |   |
    |                        | +--------------------+   |
    |                        |                          |
    |                        | TI                       |
    |                        |-------------------------&gt;|
    |                        |                          | +-----------\
    |                        |                          |-| check     |
    |                        |                          | | prefix,   |
    |                        |                          | | create    |
    |                        |                          | | Reflexive |
    |                        |                          | | Interest  |
    |                        |                          | | state     |
    |                        |                          | +-----------+
    |                        |                          |
    |                        |                       RI |
    |                        |&lt;-------------------------|
    |                        | +----------------------\ |
    |                        |-| check RNP match      | |
    |                        | | of RI-PIT(dummy)(RI),| |
    |                        | | create RI-PIT(RI),   | |
    |                        | | forward RI           | |
    |                        | +----------------------+ |
    |                        |                          |
    |                     RI |                          |
    |&lt;-----------------------|                          |
    |                        |                          |
    |                        |                          |
    | RD                     |                          |
    |-----------------------&gt;|                          |
    |                        | +---------------------\  |
    |                        |-| satisfy RI-PIT(RI), |  |
    |                        | | forward RD via      |  |
    |                        | | RI-PIT(RI)          |  |
    |                        | +---------------------+  |
    |                        |                          |
    |                        | RD                       |
    |                        |-------------------------&gt;|
    |                        | +--------------------\   |
    |                        |-| remove RI-PIT(RI)  |   |
    |                        | +--------------------+   |
    .                        .                          .
    .                        .                          .
    Chunks denoted by a serial counter incrementing by 1
    for each contiguous chunk may be retrieved by
    multiple RIs and provided with RDs from the Consumer
    .                        .                          .
    .                        .                          .
    |                        |                          | +------------\
    |                        |                          |-| all        |
    |                        |                          | | parameters |
    |                        |                          | | received,  |
    |                        |                          | | answer TI  |
    |                        |                          | +------------+
    |                        |                          |
    |                        |                       TD |
    |                        |&lt;-------------------------|
    |   +------------------\ |                          |
    |   | satisfy PIT(TI), |-|                          |
    |   | forward TD       | |                          |
    |   +------------------+ |                          |
    |                        |                          |
    |                     TD |                          |
    |&lt;-----------------------|                          |
    |                        | +--------------------\   |
    |                        |-| remove             |   |
    |                        | | RI-PIT(dummy)(RI)  |   |
    |                        | | and TI-PIT(TI)     |   |
    |                        | +--------------------+   |
    |                        |                          |

    Legend:
    TI: Trigger Interest containing Reflexive Name Prefix TLV
    RI: Reflexive Interest with Reflexive Name Prefix TLV
    RNP: Reflexive Name Prefix
    RD: Data message, answering RI
    TD: Data message, answering TI
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-overview-of-message-flow-in" class="selfRef">Overview of Message Flow in CCNx</a>
          </figcaption></figure>
</div>
<p id="section-4.2-4">The reason to maintain RI-PIT(dummy) and RI-PIT for reflexive forwarding is that there maybe the case where <span><a href="#I-D.mosko-icnrg-ccnxchunking" class="internal xref">multiple chunks</a> [<a href="#I-D.mosko-icnrg-ccnxchunking" class="cite xref">I-D.mosko-icnrg-ccnxchunking</a>]</span> are requested using a single Reflexive Interest. Followings are the examples of the names without/with chunk information enclosed in TI and RIs:<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<span id="name-responses-without-with-mult"></span><figure id="figure-3">
          <div class="alignLeft art-text artwork" id="section-4.2-5.1">
<pre>
TI: ccnx:/Name=example.com/RNP=RNP1
RI: ccnx:/RNP=RNP1

TI: ccnx:/Name=example.com/RNP=RNP1
RI_1: ccnx:/RNP=RNP1/Chunk=0  ---
RI_2: ccnx:/RNP=RNP1/Chunk=1  EndChunkNumber=2
RI_3: ccnx:/RNP=RNP1/Chunk=2  EndChunkNumber=2
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-responses-without-with-mult" class="selfRef">Responses without/with multiple chunks using Reflexive Interests</a>
          </figcaption></figure>
<p id="section-4.2-6">RI-PIT MAY include a chunk number to the RNP, while RI-PIT(dummy) does not. Like an ordinary PIT entry, RI-PIT is erased whenever the corresponding RD is forwarded through the downstream face, while RI-PIT(dummy) is erased when the RI-PIT(dummy) lifetime expires or Trigger Data (TD) is received and forwarded at the forwarder.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="consumer-operation">
<section id="section-4.3">
        <h3 id="name-consumer-operation">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-consumer-operation" class="section-name selfRef">Consumer Operation</a>
        </h3>
<p id="section-4.3-1">
 A consumer that wants to employ Reflexive Forwarding
 MUST create a Trigger Interest (TI) with a Reflexive Name
 Prefix (RNP) TLV that is used by the producer when
 issuing Reflexive Interests (RI) back to the consumer. Upon
 receiving a Reflexive Interest (e.g. RI1 in 
 <a href="#overall-message-flow-ccnx" class="auto internal xref">Figure 2</a>) from a producer in response
 to the Interest whose first name segment is the RNP supplied
 earlier, the consumer SHOULD perform a name match against the
 object specified in the RI, and return that
 object to the producer in a conventional Data message,
 (e.g. RD1 in 
 <a href="#overall-message-flow-ccnx" class="auto internal xref">Figure 2</a>).<a href="#section-4.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="naming">
<section id="section-4.4">
        <h3 id="name-naming-of-reflexive-interes">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-naming-of-reflexive-interes" class="section-name selfRef">Naming of Reflexive Interests</a>
        </h3>
<p id="section-4.4-1">
 A consumer may have one or more objects for the producer to
 fetch, and therefore needs to communicate enough information
 in its initial Trigger Interest to allow the producer to construct
 properly formed Reflexive Interest names. For some
 applications the set of <em>full names</em> (see <span><a href="#RFC8793" class="internal xref">the ICN Terminology RFC</a> [<a href="#RFC8793" class="cite xref">RFC8793</a>]</span>) is known a priori, for
 example through compile time bindings of arguments in
 an interface definition or by the architectural definition of a
 simple sensor reading. In other cases, the full names of the
 individual objects must be communicated via the RNP in the original
 Interest message.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">
 We define a new typed name segment, identified by the <em>Reflexive Interest Name Segment</em>. The Reflexive Interest Name Segment MUST be the first (i.e. high order) name segment of any Reflexive Interest issued by a producer. In CCNx, the Reflexive Interest Name Segment type value will be registered in the IANA registry for <span>[<a href="#RFC8609" class="cite xref">RFC8609</a>]</span> when approved (see <a href="#IANA" class="auto internal xref">Section 9</a>).<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3"> The value of the Reflexive Interest Name Segment is assigned by the consumer, which provides the entropy required to uniquely identify the issuing consumer for the duration of any outstanding Interest-Data exchange. For example, a UUID, which is a random 128 bit quantity specified in <span>[<a href="#RFC9562" class="cite xref">RFC9562</a>]</span>
          
 can be used for the value of the Reflexive Interest Name Segment. Any scheme that meets the randomness and entropy requirements can suffice, but the consumer SHOULD choose a different random value for the value of the Reflexive Interest Name Segment it constructs because:<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.4-4">
   <li id="section-4.4-4.1">If there is insufficient randomness, a name collision on
   the Reflexive Names could occur at any of the intermediate
   forwarders which would result in the same mutability
   problems generated by poor name selection in other contexts;
   and<a href="#section-4.4-4.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.4-4.2">Re-use of the same reflexive interest name over multiple
   interactions might reveal linkability information that could
   be used by surveillance adversaries for tracking purposes.<a href="#section-4.4-4.2" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-4.4-5">
 This initial name segment is either communicated by itself
 through a <em>Reflexive Name Prefix TLV</em> in the
 originating Interest, or prepended to any object names the
 consumer wishes the producer to fetch explicitly where there
 is more than one object needed by the producer for the
 current Interest-Data interaction. There are four cases to consider:<a href="#section-4.4-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.4-6">
   <li id="section-4.4-6.1">
<div id="single-reflexive-object">
     The reflexive <em>fullname</em> of a single object to fetch.<a href="#single-reflexive-object" class="pilcrow">¶</a>
</div>
          </li>
<li id="section-4.4-6.2">
     A single reflexive name prefix out of which the producer
     can (by application-specific means) construct a number of
     <em>fullnames</em> of the objects it may want to fetch.<a href="#section-4.4-6.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.4-6.3">
     The reflexive <em>fullname</em> of a <span><a href="#I-D.irtf-icnrg-flic" class="internal xref">FLIC Manifest</a> [<a href="#I-D.irtf-icnrg-flic" class="cite xref">I-D.irtf-icnrg-flic</a>]</span>
     enumerating the suffixes that may be used by the producer
     to construct the necessary names. We distinguish this from the single object fetch
     in <span><a href="#single-reflexive-object" class="internal xref">case</a> (<a href="#single-reflexive-object" class="auto internal xref">1</a>)</span> above because 
     the use of a Manifest implies multiple reflexive Interest/Data exchanges with the consumer.<a href="#section-4.4-6.3" class="pilcrow">¶</a>
</li>
          <li id="section-4.4-6.4">
     Multiple Reflexive Name Prefix TLVs MAY be included in the
     Interest message if none of the above 3 options covers the
     desired use case.<a href="#section-4.4-6.4" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-4.4-7">
 The last of the four options above, while not explicitly
 outlawed, SHOULD NOT be used. This is because it results in
 a longer Interest message and requires extra PIT
 resources. Hence, it is more likely a forwarder will reject
 the Interest for lack of resources. A forwarder MAY optimize
 for the case of a single Reflexive Name Prefix TLV at the expense
 of those with more than one.<a href="#section-4.4-7" class="pilcrow">¶</a></p>
<aside id="section-4.4-8">
          <p id="section-4.4-8.1"><strong>[HA]</strong> IMO, above statement is not sufficient as "SHOULD NOT" does not prohibit for some implementations to implement multiple RNPs for a single RI. It is necessary to clarify how to deal with or support multiple RNPs included in one TI. For example, if TI includes two RNPs, the following cases can be considered; (1) one RI including two RNPs is invoked, and (2) each RNP is sent one RI separately, meaning two RIs are invoked for two RNPs. For (1), RD must include two data objects, while it is a different concept from the regular CCNx (and NDN, maybe); therefore (1) is not suitable. On the other hand, for (2), two RDs are sent for each data object. It requires that two RI-PIT entries must be maintained when TI is received, but it may be able to work properly. So, my recommendation is that the following sentence should be appended at the above statemtents: "Note that if multiple RNP TLVs are included in one TI, each RNP TLV MUST be separately formed and independently sent in one RI."<a href="#section-4.4-8.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-4.4-9">
 A producer, upon receiving an Interest with one or more
 Reflexive Name Prefix TLVs, may decide it needs to retrieve the
 associated data object(s). It therefore can issue one or
 more Reflexive Interests by appending the necessary name
 segments needed to form valid full names of the associated
 objects present at the originating consumer. These in fact
 comprise conventional Interest-Data exchanges, with no
 alteration of the usual semantics with regard to signatures,
 caching, expiration, etc. When the producer has retrieved
 the required objects to complete the original Interest-Data
 exchange, it can issue its Data response, which unwinds all
 the established state at the producer, the consumer, and the
 intermediate forwarders.<a href="#section-4.4-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="producer-operation">
<section id="section-4.5">
        <h3 id="name-producer-operation">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-producer-operation" class="section-name selfRef">Producer Operation</a>
        </h3>
<p id="section-4.5-1">A producer that has received an Interest with a Reflexive Name Prefix (RNP) MUST keep the supplied RNP from the received Interest for subsequent (optional, depending on application semantics) Reflexive Interest sending.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">When sending a Reflexive Interest back to the consumer, the
 producer MUST construct a corresponding Interest name based on
 the RNP in the reflexive Interest.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="forwarder-operation">
<section id="section-4.6">
        <h3 id="name-forwarder-operation">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-forwarder-operation" class="section-name selfRef">Forwarder Operation</a>
        </h3>
<ol start="1" type="1" class="normal type-1" id="section-4.6-1">
 <li id="section-4.6-1.1">
            <p id="section-4.6-1.1.1">Upon receiving an Interest containing a Reflexive Name Prefix (RNP) TLV a forwarder MAY check its CS for a matching Data Object. if a match is found, the corresponding Data is returned and the Reflexive Interest is considered satisfied. If no match is found, proceed with the following steps.<a href="#section-4.6-1.1.1" class="pilcrow">¶</a></p>
<p id="section-4.6-1.1.2"><strong>[HA]</strong> If Trigger Data is cached in CS, the next Trigger Interest whose name is the same of the previous one may not reach to the producer, and hence the producer cannot send Reflexive Interest to make the consumer push the data. It is not a wrong behavior because caching the TD implies that the pushed data (RD) was previously sent to the producer and it is not necessary to send the same RD to the producer again. However, it may be an unexpected behavior for the consumer because the consumer cannot push the data to the publisher until the caches in the network are perfectly expired/removed. This explanation (attention) must be clearly mentioned here or some place.<a href="#section-4.6-1.1.2" class="pilcrow">¶</a></p>
<p id="section-4.6-1.1.3"><strong>Note:</strong> Given that reflexive interests initiate exchanges constrained by the Interest Lifetime of the enclosing Interest/Data exchange, the value of caching the Data responses in forwarders is for short-term recovery from lost packets as opposed to optimizing longer term caching gain. For this reason we avoid mandating or strongly recommending the CS check for reflexive interests.<a href="#section-4.6-1.1.3" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.6-1.2">
 The forwarder then MUST record the RNP as an element of the PIT entry for that Interest. (For interactions with Interest aggregation, also see <a href="#interest-aggregation" class="auto internal xref">Section 6.1.3</a>).<a href="#section-4.6-1.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.6-1.3">
 The forwarders MUST check that the high-order Name segment of the Interest is of
 type Reflexive Name Segment. If not, while this could strictly speaking be
 considered an error, the forwarder SHOULD simply process the Interest as a normal
 non-reflexive Interest and skip the steps below. A match
 indicates that this is a Reflexive Interest corresponding to
 the original consumer to producer Interest, so execute the
 following steps.<a href="#section-4.6-1.3" class="pilcrow">¶</a>
</li>
          <li id="section-4.6-1.4">
 Create a new PIT entry for the Reflexive Interest (if
 resources are sufficient).<a href="#section-4.6-1.4" class="pilcrow">¶</a>
</li>
          <li id="section-4.6-1.5">
 Look up the ingress face from the originating Interest's PIT
 entry, forward the Reflexive Interest on this face.<a href="#section-4.6-1.5" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-4.6-2">
 The PIT entry for the Reflexive Interest is consumed per regular
 Interest/Data message forwarding requirements. The PIT entry for
 the originating Interest (that communicated the Reflexive
 Interest Name) is also consumed by a final Data message from the
 producer to the original consumer.<a href="#section-4.6-2" class="pilcrow">¶</a></p>
<div id="forwarder-pseudocode">
<section id="section-4.6.1">
          <h4 id="name-forwarder-algorithms-in-pse">
<a href="#section-4.6.1" class="section-number selfRef">4.6.1. </a><a href="#name-forwarder-algorithms-in-pse" class="section-name selfRef">Forwarder algorithms in pseudocode</a>
          </h4>
<p id="section-4.6.1-1">This section provides some pseudocode examples to further explain the details of forwarder operation.
     It has separate code paths for minimal forwarder operations and those needed by high-performance forwarders as is
     further discussed in <a href="#PIT-sharding" class="auto internal xref">Section 6.1.1, Paragraph 4</a>.<a href="#section-4.6.1-1" class="pilcrow">¶</a></p>
<section id="section-4.6.1.1">
            <h5 id="name-processing-of-a-trigger-int">
<a href="#section-4.6.1.1" class="section-number selfRef">4.6.1.1. </a><a href="#name-processing-of-a-trigger-int" class="section-name selfRef">Processing of a Trigger Interest containing a Reflexive Name Prefix TLV</a>
            </h5>
<div class="lang-pseudocode sourcecode" id="section-4.6.1.1-1">
<pre>
Create PIT entry for Interest;
Optionally create a dummy PIT entry for any potential Reflexive Interests
     expected to match the RNP (or RNPs) in the Trigger Interest;
Forward Interest upstream;
</pre><a href="#section-4.6.1.1-1" class="pilcrow">¶</a>
</div>
</section>
<section id="section-4.6.1.2">
            <h5 id="name-processing-of-a-reflexive-i">
<a href="#section-4.6.1.2" class="section-number selfRef">4.6.1.2. </a><a href="#name-processing-of-a-reflexive-i" class="section-name selfRef">Processing of a Reflexive Interest</a>
            </h5>
<div class="lang-pseudocode sourcecode" id="section-4.6.1.2-1">
<pre>
Use RNP of Interest's Name TLV to lookup original Interest PIT entry;

IF PIT entry of original Interest not is found
    Issue an Interest Return with "No Route" error
         back to the producer;
    RETURN;
ELSE
    Create PIT entry for Reflexive Interest
    (or optionally modify the dummy RI PIT entry that was created together
     with the Trigger Interest PIT entry);
    Process as a normal Interest;
</pre><a href="#section-4.6.1.2-1" class="pilcrow">¶</a>
</div>
</section>
</section>
</div>
</section>
</div>
<div id="state-coupling">
<section id="section-4.7">
        <h3 id="name-state-coupling-between-prod">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-state-coupling-between-prod" class="section-name selfRef">State coupling between producer and consumer</a>
        </h3>
<p id="section-4.7-1">
    A consumer that wishes to use this scheme MUST utilize one of the
    reflexive naming options defined in <a href="#naming" class="auto internal xref">Section 4.4</a> and
    include it in the corresponding Interest message. The Reflexive
    Name Prefix TLV <em>and</em> the full name of the requested data object
    (that identifies the producer) identify the common state shared by
    the consumer and the producer. When the producer responds by
    sending Interests with a Reflexive Name Prefix, the original
    consumer therefore has sufficient information to map these
    Interests to the ongoing Interest-Data exchange.<a href="#section-4.7-1" class="pilcrow">¶</a></p>
<p id="section-4.7-2">
      The exchange is finished when the producer who received the
      Trigger Interest message responds with a Data message (or an
      Interest Return message in the case of error) answering the
      Trigger Interest. After sending this Data message, the producer
      SHOULD destroy the corresponding shared state.  It MAY decide to
      use a timer that will trigger a later state destruction. After
      receiving this Data message, the originating consumer MUST
      destroy the corresponding Interest-Data exchange state.<a href="#section-4.7-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-5">
      <h2 id="name-use-cases-for-reflexive-int">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-use-cases-for-reflexive-int" class="section-name selfRef">Use cases for Reflexive Interests</a>
      </h2>
<div id="RMI">
<section id="section-5.1">
        <h3 id="name-achieving-remote-method-inv">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-achieving-remote-method-inv" class="section-name selfRef">Achieving Remote Method Invocation with Reflexive Interests</a>
        </h3>
<p id="section-5.1-1">
 RICE (Remote Method Invocation in ICN) <span>[<a href="#Krol2018" class="cite xref">Krol2018</a>]</span> used a similar Reflexive Interest Forwarding
 scheme that inspired the design specified in this document (similar to the original design captured in <a href="#fib-based-design" class="auto internal xref">Appendix A.1</a>).<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">
 In RICE, the original Interest denotes the remote method (plus
 potential parameters) to be invoked at a producer
 (server). Before committing any computing resources, the
 server can then request authentication credentials and
 (optional) parameters using reflexive Interest-Data exchanges.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">
 When the server has obtained the necessary credentials and
 input parameters, it can decide to commit computing
 resources, starts the compute process, and returns a handle
 ("Thunk") in the final Data message to the original consumer
 (client).<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">
 The client would later request the computation results using a
 regular Interest-Data exchange (outside the Reflexive-Interest
 transaction), using the Thunk as a name for the computation
 result.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">
 <a href="#rice-message-flow" class="auto internal xref">Figure 4</a> depicts an abstract message
 diagram for RICE. In addition to the 4-way Reflexive
 Forwarding Handshake 
 
 for the details of the
 interaction, RICE adds another (standard) ICN Interest/Data
 exchange for transmitting the RMI result. The Thunk name is
 provided to the consumer in the D1 DATA message (answering the
 initial I1 Interest).<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<span id="name-rice-message-flow"></span><div id="rice-message-flow">
<figure id="figure-4">
          <div class="alignLeft art-ascii-art art-text artwork" id="section-5.1-6.1">
<pre>+-----------+              +-----------+
| Consumer  |              | Producer  |
+-----------+              +-----------+
      |                          |
      | I1                       |
      |-------------------------&gt;|
      |                          | ---------------------\
      |                          |-| Requesting request |
      |                          | | parameters         |
      |                          | | and credentials    |
      |                          | |--------------------|
      |                          |
      |                      RI1 |
      |&lt;-------------------------|
      |                          |
      | RD1                      |
      |-------------------------&gt;|
      |                          | --------------------\
      |                          |-| Commit compute    |
      |                          | | resources,        |
      |                          | | return Thunk name |
      |                          | |-------------------|
      |                          |
      |                       D1 |
      |&lt;-------------------------|
      |                          | ----------------\
      |                          |-| Invoke Remote |
      |                          | | Method        |
      |                          | |---------------|
      | -------------------\     |
      |-| After some time, |     |
      | | request result   |     |
      | |------------------|     |
      |                          |
      | I2                       |
      |-------------------------&gt;|
      |                          |
      |                       D2 |
      |&lt;-------------------------|
      |                          |
</pre>
</div>
<div class="alignLeft art-ascii-art art-text artwork" id="section-5.1-6.2">
<pre>
    Legend:
    I1: Interest #1 containing the Reflexive Name Prefix TLV
    D1: Data message, answering initiating I1 Interest,
        returning Thunk name
    RI1: Reflexive Interest issued by producer
    RD1: Data message, answering RI (parameters, credentials)
    I2: Regular Interest for Thunk (compute result)
    D2: Data message, answering I2
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-rice-message-flow" class="selfRef">RICE Message Flow</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="web">
<section id="section-5.2">
        <h3 id="name-restful-web-interactions">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-restful-web-interactions" class="section-name selfRef">RESTful Web Interactions</a>
        </h3>
<p id="section-5.2-1">
 In todays HTTP-based web, RESTful (Representational State
 Transfer) web interactions are realized by sending requests in
 a client/server interaction, where the requests provides the
 application context (or a reference to it). It has been noted
 in <span>[<a href="#Moiseenko2014" class="cite xref">Moiseenko2014</a>]</span> that corresponding requests
 often exceed the response messages in size, and that this
 raises the problems noted in <a href="#push-problems" class="auto internal xref">Section 1.1</a> 
 when attempting to map such exchanges directly to CCNx/NDN.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">
 Another reason not to include all request parameters in a
 (possibly encrypted) Interest message is the fact that a
 server (that is serving thousands of clients) would be obliged
 to receive, possibly decrypt and parse the complete requests
 before being able to determine whether the requestor is
 authorized, whether the request can be served etc. Many
 non-trivial requests could thus lead to computational overload
 attacks.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">
 Using Reflexive Interest Forwarding for RESTful Web
 Interactions would encode the REST request in the original
 request, together with a Reflexive Interest Prefix that the
 server could then use to get back to the client for
 authentication credentials and request parameters, such as
 cookies. The request result (response message) could either be
 transmitted in the Data message answering the original
 request, or — in case of dynamic, longer-running computations
 — in a seperate Interest/Data exchange, potentially
 leveraging the Thunk scheme described in <a href="#RMI" class="auto internal xref">Section 5.1</a>.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">
 Unlike approaches where clients have to signal a globally
 routable prefix to the network, this approach would not
 require the client (original consumer) to expose its identity
 to the network (the network only sees the temporary Reflexive
 Name Prefix), but it would still be possible to
 authenticate the client at the server.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5">An initial design for achieving RESTful ICN that employs reflexive forwarding is presented in <span>[<a href="#Kutscher2022" class="cite xref">Kutscher2022</a>]</span>.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="phone-home">
<section id="section-5.3">
        <h3 id="name-achieving-simple-data-pull-">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-achieving-simple-data-pull-" class="section-name selfRef">Achieving simple data pull from consumers with reflexive Interests</a>
        </h3>
<p id="section-5.3-1">
 An oft-cited use case for ICN network architectures is
 <em>Internet of Things</em> (IoT), where the sources of data
 are limited-resource sensor/actuators. Many approaches have
 been tried (e.g. <span>[<a href="#Baccelli2014" class="cite xref">Baccelli2014</a>]</span>, <span>[<a href="#Lindgren2016" class="cite xref">Lindgren2016</a>]</span>, <span>[<a href="#Gundogan2018" class="cite xref">Gundogan2018</a>]</span>) with
 varying degrees of success in addressing the issues outlined
 in <a href="#push-problems" class="auto internal xref">Section 1.1</a>. The reflexive forwarding
 extension may substantially ameliorate the documented
 difficulties by allowing a different model for the basic
 interaction of sensors with the ICN network.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">
 Instead of simply acting as a producer (either directly to the
 Internet or indirectly through the use of some form of
 application-layer gateway), the IoT device need only act as a
 consumer to initiate commuhication. When it has data to provide, it issues a
 "phone-home" Interest message to a pre-configured rendezvous
 name (e.g. an application-layer gateway or ICN <span><a href="#Chen2015" class="internal xref">Repo</a> [<a href="#Chen2015" class="cite xref">Chen2015</a>]</span>) and provides a reflexive name
 prefix TLV for the data it wishes to publish. The target
 producer may then issue the necessary reflexive Interest
 message(s) to fetch the data. Once fetched, validated, and
 stored, the producer then responds to the original Interest
 message with a success indication, possibly containing a Data
 object if needed to allow the originating device to modify its
 internal state. Alternatively, the producer might choose to
 not respond and allow the original Interest to time out,
 although this is NOT RECOMMENDED except in cases where the
 extra message transmission bandwith is at a premium compared
 to the persistence of stale state in the forwarders. We note
 that this interaction approach mirrors the earlier efforts using
 Interest-Interest-Data designs.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">
 <a href="#phonehome-message-flow" class="auto internal xref">Figure 5</a> depicts this
 interaction with the (optional) D1 message.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<span id="name-phone-home-message-flow"></span><div id="phonehome-message-flow">
<figure id="figure-5">
          <div class="alignLeft art-ascii-art art-text artwork" id="section-5.3-4.1">
<pre>             +-----------+         +-----------+
             | Consumer  |         | Producer  |
             +-----------+         +-----------+
     ------------\ |                     |
     | new IoT   |-|                     |
     | data item | |                     |
     | produced  | |                     |
     |-----------| |                     |
  ---------------\ |                     |
  | "phone home" |-|                     |
  | by notifying | |                     |
  | producer     | |                     |
  |--------------| |                     |
                   |                     |
                   | I1                  |
                   |--------------------&gt;|
                   |                     | --------------------\
                   |                     |-| generate Interest |
                   |                     | | for IoT data      |
                   |                     | |-------------------|
                   |                     |
                   |                 RI1 |
                   |&lt;--------------------|
-----------------\ |                     |
| send requested |-|                     |
| data object    | |                     |
|----------------| |                     |
                   |                     |
                   | RD1                 |
                   |--------------------&gt;|
                   |                     | -----------------------\
                   |                     |-| finalize interaction |
                   |                     | | with optional        |
                   |                     | | Data message         |
                   |                     | |----------------------|
                   |                     |
                   |       D1 (optional) |
                   |&lt;--------------------|
                   |                     |
</pre>
</div>
<div class="alignLeft art-ascii-art art-text artwork" id="section-5.3-4.2">
<pre>
    Legend:
    I1: Trigger Interest #1 containing the Reflexive Name Prefix TLV
    D1: Data message (OPTIONAL), finalizing interaction
    RI1: Reflexive Interest requesting the IoT data
    RD1: Data message, answering RI, returning IoT data object
    D1: (optional) Data answering I1
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-phone-home-message-flow" class="selfRef">"Phone Home" Message Flow</a>
          </figcaption></figure>
</div>
<p id="section-5.3-5">
 There are two approaches that the IoT device can use for
 its response to a Reflexive Interest. It can simply construct
 a Data Message bound through the usual ICN hash name to the
 Reflexive Interest name. Since the scope of any data object
 bound in this way is only the duration of the enclosing
 Interest-Data exchange (see <a href="#consumer-implementation" class="auto internal xref">Section 6.2</a>) the producer would need to
 itself construct any persistent Data object, name it, and sign
 it. This is sometimes the right approach, as for some
 applications the identity of the originating IoT device is not
 important from an operational or security point of view; in
 contrast the identity of the gateway or Repo is what matters.<a href="#section-5.3-5" class="pilcrow">¶</a></p>
<p id="section-5.3-6">
 If alternatively, the persistent Data object should be bound
 from a naming and security point of view to the originating
 IoT device, this can be easily accomplished. Instead of
 directly placing the content in a Data object responding to
 the reflexive Interest as above, the consumer encapsulates a
 complete CCNx/NDN Data message (which includes the desired name
 of the data) in the response to the Reflexive Interest
 message.<a href="#section-5.3-6" class="pilcrow">¶</a></p>
<p id="section-5.3-7">
 The interaction model described above brings a number
 potential advantages, some obvious, some less so. We enumerate
 a few of them as follows:<a href="#section-5.3-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-8.1">
   By not requiring the IoT device to be actively listening for
   Interests, it can sleep and only wake up if it has something
   to communicate. Conversely, parties interested in obtaining
   data from the device do not need to be constantly polling in
   order to ascertain if there is new data available.<a href="#section-5.3-8.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-8.2">
   No forwarder resources are tied up with state apart from the
   actual reflexive forwarding interactions. All that is needed
   is enough routing state in the FIB to be able to forward the
   "phone home" Interest to an appropriate target
   producer. While this model does not provide all the richness
   of a full Pub/Sub system (like that described in <span>[<a href="#Gundogan2018" class="cite xref">Gundogan2018</a>]</span>) we argue it is adequate for a large
   subclass of such applications.<a href="#section-5.3-8.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-8.3">
   The Reflexive interest, through either a name suffix or
   Interest payload, can give the IoT device useful context
   from which to craft its Data object in response. One highly
   useful parameter would be a robust clock value for the
   device to use as a timestamp of the data, possibly as part
   of its name, to correctly place it in a time seres of sensor
   readings. This substantially alleviates the need for low-end
   devices to have a robust time base, as long as they trust
   the producer they contact to provide it.<a href="#section-5.3-8.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
<div id="implementation-considerations">
<section id="section-6">
      <h2 id="name-implementation-consideratio">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-implementation-consideratio" class="section-name selfRef">Implementation Considerations</a>
      </h2>
<p id="section-6-1">There are a number of important aspects to the reflexive
   forwarding design which affect correctness and performance
   of existing forwarder, consumer, and producer
   implementations desiring to support it. This section
   discusses the effect of each of these elements on the
   protocol architecture.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="forwarder-implementation">
<section id="section-6.1">
        <h3 id="name-forwarder-implementation-co">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-forwarder-implementation-co" class="section-name selfRef">Forwarder implementation considerations</a>
        </h3>
<section id="section-6.1.1">
          <h4 id="name-interactions-with-input-pro">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-interactions-with-input-pro" class="section-name selfRef">Interactions with Input Processing of Interest and Data packets</a>
          </h4>
<p id="section-6.1.1-1">Reflexive Interests are designed specifically to be no
           different from any other Interest other than the use of
           the Reflexive Name Segment type as their
           high-order name segment. This means that a forwarder
           does not have to have special handling in terms of
           creation, and destruction, and other Interest processing
           needs such as timeouts, Interest satisfaction, and caching
           of returning data in the CS if desired. However, this
           design does require additional processing for Reflexive
           Interests not needed in the absence of reflexive
           forwarding. The most significant requirements are:<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.1-2.1">
     In order to locate the corresponding PIT entry for the
     original Interest, the forwarder's packet input processing
     needs to be able to efficiently locate the PIT entry of the original 
     Interest that contained the RNP TLV.<a href="#section-6.1.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.1.1-2.2">
     Ensure that the high order name segment of the Reflexive
     Interest matches the RNP stored in that PIT entry.<a href="#section-6.1.1-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.1.1-3">There are a few additional considerations to highlight for
     high-speed forwarders however; these are discussed in the
     following paragraphs.<a href="#section-6.1.1-3" class="pilcrow">¶</a></p>
<div id="PIT-sharding">
<p id="section-6.1.1-4">In order to achieve forwarding scalability, high speed
       forwarders need to exploit available parallelism in both CPU
       (through multiple cores) and memory (through multiport DRAM
       and limiting accesses to both DRAM and L3 caches). One
       commonly-used technique is <em>PIT sharding</em>, where the
       forwarder-global PIT is partitoned among cores such that all
       processing of both Interest and Data for a given Name is
       directed at the same core, optimizing both L1 I-cache
       utilization and L2/L3/DRAM throughput and latency. This is
       achieved in a number of implementations (e.g. <span>[<a href="#So2013" class="cite xref">So2013</a>]</span>) by hashing the fullname in the Interest or
       Data and using that hash to select the assigned processing
       core (and associated memory banks). This efficiently
       distributes the load and minimizes the number of memory
       accesses other than to bytes of the input packet.<a href="#section-6.1.1-4" class="pilcrow">¶</a></p>
</div>
<p id="section-6.1.1-5">Straightforward input name hashing to achieve a sharded PIT
       has one potentially undesirable side effect: the original
       Interest containing the Reflexive Name Prefix TLV and any
       resultant reflexive Interests issued by the producer will likely hash
       to different PIT shards, making any pointers that need to be
       traversed across shards or cross-shard updates expensive,
       possibly dramatically so. One could either optimize those
       accesses (as, for example, suggested in the discussion of
       Interest Lifetime in <a href="#interest-lifetime" class="auto internal xref">Section 6.1.2</a>) or
       add special input handling of reflexive interests to steer
       them to the same shard as the original interest.<a href="#section-6.1.1-5" class="pilcrow">¶</a></p>
</section>
<div id="interest-lifetime">
<section id="section-6.1.2">
          <h4 id="name-interactions-with-interest-">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-interactions-with-interest-" class="section-name selfRef">Interactions with Interest Lifetime</a>
          </h4>
<p id="section-6.1.2-1">If and when a producer decides to fetch data from
       the consumer using one or more reflexive Interest-Data
       exchanges, the total latency for the original
       Interest-Data exchange is inflated, potentially by
       multiple RTTs. It is difficult for a consumer to
       predict the inflation factor when issuing the original
       Interest, and hence there can be a substantial hazard
       of that Interest lifetime expiring before completion
       of the full multi-way exchange. This can result in
       persistent failures, which is obviously highly
       undesirable.<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
<p id="section-6.1.2-2">There is a fairly straightforward technique that
       can be employed by forwarders to avoid these "false"
       Interest lifetime expirations. In the absence of a
       superior alternative technique, it is RECOMMENDED that
       all forwarders implement the following algorithm.<a href="#section-6.1.2-2" class="pilcrow">¶</a></p>
<p id="section-6.1.2-3">If and when a reflexive Interest arrives matching
       the original Interest's PIT entry, the forwarder examines the
       Interest lifetime of the arriving reflexive
       Interest. Call this value <em>IL<sub>r</sub></em>. The
       forwarder computes MAX(<em>IL<sub>t</sub>,
       (IL<sub>r</sub> * 1.5)</em>), and replaces
       <em>IL<sub>t</sub></em> with this value. This in
       effect ensures that the remaining Interest lifetime of
       the original Interest accounts for the additional 1.5
       RTTs that may occur as a result of the reflexive
       Interest-Data exchange.<a href="#section-6.1.2-3" class="pilcrow">¶</a></p>
<aside id="section-6.1.2-4">
            <p id="section-6.1.2-4.1">We note that this is not unduly
 expensive in this design where the two PIT
 entries are guaranteed to be in the same PIT
 shard on a high speed forwarder. The earlier
 design discussed in <a href="#FIB-and-interest-lifetime" class="auto internal xref">Appendix A.1.2</a> required
 some additional gymnastics.<a href="#section-6.1.2-4.1" class="pilcrow">¶</a></p>
</aside>
<div id="reflexive-producer-hazard">
<p id="section-6.1.2-5">While the above
       approach of inflating the interest lifetime of the
       original Interest to accommodate the additional RTTs
       of reflexive Interest-Data exchanges avoids the
       timeout problem, this does introduce a new
       vulnerability that must be dealt with. A Producer,
       either through a bug or malicious intent, could keep
       an originating Interest-Data exchange alive by
       continuing to send reflexive Interests back to the
       consumer, while the consumer had no way to terminate
       the enclosing interaction (there is no "cancel
       Interest" function in either NDN nor CCNx). To
       eliminate this hazard, if the consumer rejects a
       reflexive interest with a T_RETURN_PROHIBITED error,
       the forwarder(s), in addition to satisfying the
       corresponding PIT entry, MUST also delete the
       RNP from the original Interest's PIT entry, thereby preventing any
       further reflexive Interests from reaching the
       consumer. This allows the enclosing Interest-Data
       exchange to either time out or be correctly ended with
       a Data message or Interest Return from the
       Producer.<a href="#section-6.1.2-5" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="interest-aggregation">
<section id="section-6.1.3">
          <h4 id="name-interactions-with-interest-a">
<a href="#section-6.1.3" class="section-number selfRef">6.1.3. </a><a href="#name-interactions-with-interest-a" class="section-name selfRef">Interactions with Interest aggregation and multi-path/multi-destination forwarding</a>
          </h4>
<p id="section-6.1.3-1">As with numerous other situations where multiple Interests
       for the same named object arrive containing different
       parameters (e.g. Interest Lifetime, QoS, payload hash) the
       same phenomenon occurs for the reflexive Name Prefix TLV. If
       Interests with different reflexive name prefix TLVs collide,
       the forwarder MUST NOT aggregate these Interest messages and
       instead MUST create a separate PIT entry for each.<a href="#section-6.1.3-1" class="pilcrow">¶</a></p>
<p id="section-6.1.3-2">Forwarders supporting multi-path forwarding may of course
       exploit this capability for Interests with identical reflexive
       name prefix TLVs, like any other Interests. There are two
       sub-cases of multi-next hop behavior; regular multi-path
       (where the split traffic reconverges further upstream) and
       multi-destination (where it doesn't and the Interest reaches
       multiple producers).<a href="#section-6.1.3-2" class="pilcrow">¶</a></p>
<p id="section-6.1.3-3">For multi-path, since the Interests that converge upstream
 carry identical reflexive Interest name TLVs, they will get
 aggregated. The forwarder might, just as for any other
 Interest, decide to either do single or multi-path forwarding
 of that reflexive Interest. If sent multi-path in parallel,
 these also will reconverge on the inverse path and get
 aggregated.<a href="#section-6.1.3-3" class="pilcrow">¶</a></p>
<p id="section-6.1.3-4">For multi-destination, reflexive Interests might get issued
 by multiple producers, but they will carry the same reflexive
 name prefix and hence be forwarded using the ingress face of the same
 original Interest PIT entry until reaching the join point, at which they will get
 aggregated and thus handled identically to any other
 Interest(s) subject to aggregation.<a href="#section-6.1.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="consumer-implementation">
<section id="section-6.2">
        <h3 id="name-consumer-implementation-con">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-consumer-implementation-con" class="section-name selfRef">Consumer Implementation Considerations</a>
        </h3>
<section id="section-6.2.1">
          <h4 id="name-data-objects-returned-by-th">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-data-objects-returned-by-th" class="section-name selfRef">Data objects returned by the consumer to reflexive name Interests arriving from a producer</a>
          </h4>
<p id="section-6.2.1-1">The Data objects returned to the producer in response to a
     reflexive Interest are normal CCNx/NDN data objects. The object returned
     in response to a reflexive Interest is named with its hash as the trailing
     segment of the reflexive Interest name, and hence the scope
     of the object is under most circumstances meaningful only for
     the duration of the enclosing Interest-Data interaction. This
     property is ideal for naming and securing data that is "part
     of" the enclosing interaction — things like method arguments,
     authenticators, and key exchange parameters, but not for the
     creation and naming of objects intended to survive outside the
     current interaction's scope (c.f. <a href="#phone-home" class="auto internal xref">Section 5.3</a>,
     which describes how to provide globally-named objects using
     encapsulation). In general, the consumer should use the
     following guidelines in creating Data messages in response to
     reflexive Interest messages from the producer.<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-6.2.1-2">
     <dt>(a)</dt>
<dd id="section-6.2.1-2.1">Set the recommended cache time (T_CACHETIME) either to zero, or a value no greater than the Interest lifetime (T_INTLIFE) of the original Interest message.<a href="#section-6.2.1-2.1" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt>(b)</dt>
<dd id="section-6.2.1-2.2">Set the payload type (T_PAYLDTYPE) according to the type of object being returned (e.g. object, link, manifest)<a href="#section-6.2.1-2.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt>(c)</dt>
<dd id="section-6.2.1-2.3">Set the expiry time (T_EXPIRY) to a value greater than <em>now</em>, and less than or equal to the <em>now</em> + Interest lifetime (T_INTLIFE) of the original Interest message.<a href="#section-6.2.1-2.3" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
<section id="section-6.2.2">
          <h4 id="name-terminating-unwanted-reflex">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-terminating-unwanted-reflex" class="section-name selfRef">Terminating unwanted reflexive Interest exchanges</a>
          </h4>
<p id="section-6.2.2-1">A consumer may wish to stop receiving reflexive Interests due to possible errors or malicious behavior on the part of the producer. Therefore, if the consumer receives an unwanted reflexive Interest, it SHOULD reject that interest with a T_RETURN_PROHIBITED error (See section 10.3.6 of <span>[<a href="#RFC8609" class="cite xref">RFC8609</a>]</span> ). This will provoke the forwarders to prevent further reflexive Interests from reaching the consumer, as described above in <a href="#reflexive-producer-hazard" class="auto internal xref">Section 6.1.2, Paragraph 5</a>.<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
</section>
<section id="section-6.2.3">
          <h4 id="name-interactions-with-caching">
<a href="#section-6.2.3" class="section-number selfRef">6.2.3. </a><a href="#name-interactions-with-caching" class="section-name selfRef">Interactions with caching</a>
          </h4>
<p id="section-6.2.3-1">
   The reflexive named objects provide "local", temporary names
   that are only defined for one specific interaction between a
   consumer and a producer. Corresponding Data objects MUST NOT
   be shared among multiple consumers (violating this would require special gyrations by the producer since the reflexive Name utilizes per-consumer/per-interaction random values). A producer MUST NOT issue an Interest message for any reflexive name after it has sent the final Data message answering the original Interest.<a href="#section-6.2.3-1" class="pilcrow">¶</a></p>
<p id="section-6.2.3-2">
   Forwarders MAY still cache reflexive Data objects for
   retransmissions within a transactions, but they MUST invalidate or remove
   them from the content store when they forward the final Data
   message answering the original Interest.<a href="#section-6.2.3-2" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="producer-implementation">
<section id="section-6.3">
        <h3 id="name-producer-implementation-con">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-producer-implementation-con" class="section-name selfRef">Producer Implementation Considerations</a>
        </h3>
<p id="section-6.3-1">Producers receiving an Interest with a Reflexive Name
 Segment, MAY decide to issue Reflexive Interests for the corresponding
 Data objects. All Reflexive Interest messages that a producer
 sends MUST be sent over the face that the original Interest
 was received on.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="Ops">
<section id="section-7">
      <h2 id="name-operational-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-operational-considerations" class="section-name selfRef">Operational Considerations</a>
      </h2>
<p id="section-7-1">This extension represents a substantial enhancement to the
 CCNx/NDN protocol architecture and hence has important forward
 and backward compatibility consequences. The most important of
 these is that correct operation of the scheme requires an
 unbroken chain of forwarders between the consumer and the
 desired producer that support the Reflexive Name Prefix TLV and the
 corresponding forwarder capabilities specified in <a href="#forwarder-operation" class="auto internal xref">Section 4.6</a>. When this invariant is not
 satisfied, some means is necessary to detect and hopefully
 recover from the error. We have identified three possible
 approaches to handling the lack of universal deployment of
 forwarders supporting the reflexive forwarding scheme.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">The first approach simply lets the producer detect the
 error by getting a "no route to destination" error when trying
 to send an Interest to a reflexive name. This will catch the
 error, but only after forwarding resources are tied up and the
 producer has done some work on the original Interest
 message. Further, the producer would need a bit of smarts to
 determine that this is a permanent error and not a transient
 to be retried. In order for the consumer to attempt recovery,
 there might be a need for some explicit error returned for the
 original interest to tell the consumer what the likely problem
 is. This approach does not enable an obvious recovery path for
 the consumer either, since if the producer cannot easily detect the error, 
 the consumer has no way to know if a retry has any chance of succeeding.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">A second approach is to bump the CCNx/NDN protocol version
 to explicitly indicate the lack of compatability. Such
 Interests would be rejected by forwarders not supporting these
 protocol extensions. A consumer wishing to use the Reflexive
 Name Prefix TLV would use the higher protocol version on those
 Interest messages (but could of course continue to use the
 current version number on other Interest messages). This is a
 big hammer, but may be called for in this situation
 because:<a href="#section-7-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-7-4">
 <dt>(a)</dt>
<dd id="section-7-4.1">it detects the problem immediately and
 deterministically, and<a href="#section-7-4.1" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt>(b)</dt>
<dd id="section-7-4.2">one could assume an ICN routing protocol that
 would only forward to a next hop that supports the
 updated protocol version number. The supported
 forwarder protocol versions would have been
 communicated in the routing protocol ahead of
 time.<a href="#section-7-4.2" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-7-5">A third option is to, as a precondition to utilizing the
 protocol in a deployment, create and deploy a neighbor
 capability exchange protocol which will tell a downstream
 forwarder if the upstream can handle the new TLV. This might
 avoid the large hammer of updating the protocol version, but
 of course this puts a pretty strong dependency on somebody
 actually designing and publishing such a protocol! On the
 other hand, a neighbor capability exchange protocol for
 CCNx/NDN would have a number of other substantial benefits,
 which makes it worth seriously considering anyway.<a href="#section-7-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="encoding">
<section id="section-8">
      <h2 id="name-mapping-to-ccnx-and-ndn-pac">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-mapping-to-ccnx-and-ndn-pac" class="section-name selfRef">Mapping to CCNx and NDN packet encodings</a>
      </h2>
<div id="CCNx-encoding">
<section id="section-8.1">
        <h3 id="name-packet-encoding-for-ccnx">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-packet-encoding-for-ccnx" class="section-name selfRef">Packet encoding for CCNx</a>
        </h3>
<p id="section-8.1-1" class="keepWithNext">For CCNx <span>[<a href="#RFC8609" class="cite xref">RFC8609</a>]</span>, this specification defines one new Name Segment type for the Reflexive Name Prefix TLV.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<span id="name-reflexive-name-segment"></span><table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-reflexive-name-segment" class="selfRef">Reflexive Name Segment</a>
          </caption>
<thead>
            <tr>
              <th class="text-center" rowspan="1" colspan="1">Abbrev</th>
              <th class="text-center" rowspan="1" colspan="1">Name</th>
              <th class="text-center" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">T_REFLEXIVE_NAME</td>
              <td class="text-left" rowspan="1" colspan="1">Reflexive Name Segment</td>
              <td class="text-left" rowspan="1" colspan="1">Name segment to use as name prefix in Reflexive Interest Messages</td>
            </tr>
          </tbody>
        </table>
<span id="name-reflexive-name-prefix-tlv"></span><div id="reflexive-name-encoding">
<figure id="figure-6">
          <div class="alignCenter art-text artwork" id="section-8.1-3.1">
<pre>
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|   Type (=T_REFLEXIVE_NAME)    |             Length            |
+---------------+---------------+---------------+---------------+
/                     Reflexive Name Prefix                     /
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-reflexive-name-prefix-tlv" class="selfRef">Reflexive Name Prefix TLV</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-8.1-4">
          <dt id="section-8.1-4.1">Type:</dt>
          <dd style="margin-left: 1.5em" id="section-8.1-4.2">Format of the Value field. For the Reflexive Name Prefix TLV, the type value MUST be T_REFLEXIVE_NAME in the current specification. 16 bit length.<a href="#section-8.1-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.1-4.3">Length:</dt>
          <dd style="margin-left: 1.5em" id="section-8.1-4.4">Length of Value field in octets. 16 bit length.<a href="#section-8.1-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-8.1-4.5">Reflexive Name Prefix:</dt>
          <dd style="margin-left: 1.5em" id="section-8.1-4.6">Reflexive Name Prefix (RNP) assigned by consumer. Variable length.<a href="#section-8.1-4.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="NDN-encoding">
<section id="section-8.2">
        <h3 id="name-packet-encoding-for-ndn">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-packet-encoding-for-ndn" class="section-name selfRef">Packet encoding for NDN</a>
        </h3>
<p id="section-8.2-1"><strong>These are proposed assignments based on <span>[<a href="#NDNTLV" class="cite xref">NDNTLV</a>]</span>. Suggestions from the NDN team would be greatly appreciated.</strong><a href="#section-8.2-1" class="pilcrow">¶</a></p>
<section id="section-8.2.1">
          <h4 id="name-reflexive-name-component-ty">
<a href="#section-8.2.1" class="section-number selfRef">8.2.1. </a><a href="#name-reflexive-name-component-ty" class="section-name selfRef">Reflexive Name Component Type</a>
          </h4>
<p id="section-8.2.1-1">The NDN Name component TLVs needs to have a new component type added with type RNP (for reflexive name prefix). We suggest something like: <strong>TBD</strong><a href="#section-8.2.1-1" class="pilcrow">¶</a></p>
<aside id="section-8.2.1-2">
            <p id="section-8.2.1-2.1"><strong>Note:</strong>It seems like the current 0.2.1 packet format only has allocated two name component types — a <em>GenericNameComponent</em> and a <em>ImplicitSha256DigestComponent</em>. Shouldn't there be more types by now or is this spec out of date?<a href="#section-8.2.1-2.1" class="pilcrow">¶</a></p>
</aside>
</section>
<section id="section-8.2.2">
          <h4 id="name-reflexive-name-prefix-tlv-2">
<a href="#section-8.2.2" class="section-number selfRef">8.2.2. </a><a href="#name-reflexive-name-prefix-tlv-2" class="section-name selfRef">Reflexive Name Prefix TLV</a>
          </h4>
<p id="section-8.2.2-1">The Reflexive Name Prefix TLV needs to be added to the NDN Interest packet format. We suggest using <span>[<a href="#RFC9562" class="cite xref">RFC9562</a>]</span>, hence something like:<a href="#section-8.2.2-1" class="pilcrow">¶</a></p>
<span id="name-proposed-reflexive-name-pre"></span><table class="center" id="table-2">
            <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-proposed-reflexive-name-pre" class="selfRef">Proposed Reflexive Name Prefix TLV for NDN Interest Packet</a>
            </caption>
<tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">RNP ::=</td>
                <td class="text-left" rowspan="1" colspan="1">RNP-TYPE</td>
                <td class="text-left" rowspan="1" colspan="1">TLV-LENGTH(=16) BYTE8)</td>
              </tr>
            </tbody>
          </table>
<aside id="section-8.2.2-3">
            <p id="section-8.2.2-3.1"><strong>[HA]</strong> CCNx adopts variable length for RNP. NDN as well?<a href="#section-8.2.2-3.1" class="pilcrow">¶</a></p>
</aside>
</section>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">As per <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>, this section makes an assignment in one existing registry in the "Content-Centric Networking (CCNx)" registry group. The registration procedure is "RFC Required", which requires only that this document be published as an RFC.<a href="#section-9-1" class="pilcrow">¶</a></p>
<div id="sec.iana">
<section id="section-9.1">
        <h3 id="name-ccnx-name-segment-type-regi">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-ccnx-name-segment-type-regi" class="section-name selfRef">CCNx Name Segment Type Registry</a>
        </h3>
<p id="section-9.1-1">As shown in <a href="#CCNx-encoding" class="auto internal xref">Section 8.1</a>, this document defines one message type, T_REFLEXIVE_NAME, whose suggested value is %x0005.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="Security">
<section id="section-10">
      <h2 id="name-security-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-10-1">One of the major motivations for the reflexive forwarding
      extension specified in this document is in fact to enable better
      security and privacy characteristics for ICN networks. The main
      considerations are presented in <a href="#intro" class="auto internal xref">Section 1</a>, but we
      briefly recapitulate them here:<a href="#section-10-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-2.1">Current approaches to authentication and data transfer
       often use payloads in Interest messages, which are clumsy to
       secure (Interest messages must be signed) and as a consequence
       make it very difficult to ensure consumer privacy. Reflexive
       forwarding moves all sensitive data to the Data messages sent
       in response to reflexive Interests, which are secured in the
       same manner as all other Data messages in the CCNx and NDN
       protocol designs.<a href="#section-10-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-10-2.2">In many scenarios, consumers are forced to also act as
       producers so that data may be fetched by either a particular,
       or arbitrary other party. The means the consumer must arrange
       to have a routable name prefix and that prefix be disseminated
       by the routing protocol or other means. This represents both a
       privacy hazard (by revealing possible important information
       about the consumer) and a security concern as it opens up the
       consumer to the full panoply of flooding and crafted Interest
       Denial of Service attacks.<a href="#section-10-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-10-2.3">In order to achieve multi-way handshakes, in current
       designs a consumer wishing a producer to communicate back must
       inform the producer of what (globally routable) name to
       use. This gives the consumer a convenient means to mount a
       variety of reflection attacks by enlisting the producer to
       send Interests to desired victims.<a href="#section-10-2.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-10-3">As a major protocol extension however, this design brings its
      own potential security issues, which are discussed in the
      following subsections.<a href="#section-10-3" class="pilcrow">¶</a></p>
<section id="section-10.1">
        <h3 id="name-collisions-of-reflexive-int">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-collisions-of-reflexive-int" class="section-name selfRef">Collisions of reflexive Interest names</a>
        </h3>
<p id="section-10.1-1">Reflexive Interest names are constructed using 128-bit random
      numbers. This is intended to ensure an off-path attacker cannot
      easily manufacture a matching reflexive Interest and either
      masquerade as the producer, or mount a denial of service attack
      on the consumer. It also limits tracking through the linkability
      of Interests containing a re-used random value.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<p id="section-10.1-2">Therefore consumers MUST utilize a robust means of generating
      these random values, and it is RECOMMENDED that the <span>[<a href="#RFC9562" class="cite xref">RFC9562</a>]</span> format
      be used, with a pseudo-random
      number generator (PRNG) approved for use with cryptographic
      protocols.<a href="#section-10.1-2" class="pilcrow">¶</a></p>
</section>
<section id="section-10.2">
        <h3 id="name-additional-resource-pressur">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-additional-resource-pressur" class="section-name selfRef">Additional resource pressure on PIT and FIB</a>
        </h3>
<p id="section-10.2-1">Normal Interest message processing in CCNx and NDN needs to
      consider effect of various resource depletion attacks on the
      PIT, particularly in the form of Interest flooding attacks (see
      <span>[<a href="#Gasti2012" class="cite xref">Gasti2012</a>]</span> for a good overview of DoS and DDoS
      mitigation on ICN networks). Interest messages utilizing this
      reflexive forwarding extension can place additional resource
      pressure on the PIT.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<p id="section-10.2-2">While this does not represent a new DoS/DDoS attack vector,
      the ability of a malicious consumer to utilize this extension in
      an attack does represent an increased risk of resource
      depletion, especially if such Interests are given unfair access
      to PIT and FIB resources. Implementers SHOULD therefore protect
      PIT and FIB resources by weighing requests for reflexive
      forwarding resources appropriately relative to other
      Interests.<a href="#section-10.2-2" class="pilcrow">¶</a></p>
</section>
<section id="section-10.3">
        <h3 id="name-privacy-considerations">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
        </h3>
<p id="section-10.3-1">ICN architectures like CCNx and NDN provide a rich tapestry
      of interesting privacy issues, which have been extensively
      explored in the research literature. The fundamental tradeoffs
      for privacy concern the risk of exposing the names of
      information objects to the forwarding elements of the network,
      which is a necessary property of any name-based routing and
      forwarding design. Numerous approaches have been explored with
      varying degrees of success, such as onion routing (<span>[<a href="#DiBenedettoGTU12" class="cite xref">DiBenedettoGTU12</a>]</span>), name encryption (<span>[<a href="#Ghali2017" class="cite xref">Ghali2017</a>]</span>), and name obfuscation (<span>[<a href="#Arianfar2011" class="cite xref">Arianfar2011</a>]</span>) among others.<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<p id="section-10.3-2">Reflexive forwarding does not change the overall landscape
       of privacy tradeoffs, nor seem to introduce additional
       hazards. In fact, the privacy exposures are confined to the
       inverse path of forwarders from the producer to the consumer,
       through which the original Interest forwarding may have
       already exposed names on path. Similar name privacy techniques
       to those cited above may be equally applied to the names in
       reflexive Interests.<a href="#section-10.3-2" class="pilcrow">¶</a></p>
<p id="section-10.3-3">While the individual reflexive Interest-Data exchanges have
       similar properties to those in any NDN or CCNx exchange, the
       target usages by applications may have interaction patterns
       that are subject to relatively straightforward fingerprinting
       by adversaries. For example, a particular remote method invocation may
       fingerprint simply through the count of arguments fetched by
       the producer and their sizes. The attacker must however be on
       path, which somewhat ameliorates the exposure hazards.<a href="#section-10.3-3" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<section id="section-11">
      <h2 id="name-normative-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
      <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8569">[RFC8569]</dt>
      <dd>
<span class="refAuthor">Mosko, M.</span>, <span class="refAuthor">Solis, I.</span>, and <span class="refAuthor">C. Wood</span>, <span class="refTitle">"Content-Centric Networking (CCNx) Semantics"</span>, <span class="seriesInfo">RFC 8569</span>, <span class="seriesInfo">DOI 10.17487/RFC8569</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8569">https://www.rfc-editor.org/info/rfc8569</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8609">[RFC8609]</dt>
    <dd>
<span class="refAuthor">Mosko, M.</span>, <span class="refAuthor">Solis, I.</span>, and <span class="refAuthor">C. Wood</span>, <span class="refTitle">"Content-Centric Networking (CCNx) Messages in TLV Format"</span>, <span class="seriesInfo">RFC 8609</span>, <span class="seriesInfo">DOI 10.17487/RFC8609</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8609">https://www.rfc-editor.org/info/rfc8609</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-12">
      <h2 id="name-informative-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="Arianfar2011">[Arianfar2011]</dt>
      <dd>
<span class="refAuthor">Arianfar, S.</span>, <span class="refAuthor">Koponen, T.</span>, <span class="refAuthor">Raghavan, B.</span>, and <span class="refAuthor">S. Shenker</span>, <span class="refTitle">"On preserving privacy in content-oriented networks, in ICN '11: Proceedings of the ACM SIGCOMM workshop on Information-centric networking"</span>, <span class="seriesInfo">DOI https://doi.org/10.1145/2018584.2018589</span>, <time datetime="2011-08" class="refDate">August 2011</time>, <span>&lt;<a href="https://dl.acm.org/doi/10.1145/2018584.2018589">https://dl.acm.org/doi/10.1145/2018584.2018589</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Asaeda2019">[Asaeda2019]</dt>
      <dd>
<span class="refAuthor">Asaeda, H.</span>, <span class="refAuthor">Ooka, A.</span>, <span class="refAuthor">Matsuzono, K.</span>, and <span class="refAuthor">R. Li</span>, <span class="refTitle">"Cefore: Software Platform Enabling Content-Centric Networking and Beyond"</span>, <span class="seriesInfo">IEICE Transaction on Communications, Vol.E102-B, No.9</span>, <span class="seriesInfo">DOI: 10.1587/transcom.2018EII0001</span>, <time datetime="2019-09" class="refDate">September 2019</time>, <span>&lt;<a href="https://search.ieice.org/bin/summary.php?id=e102-b_9_1792">https://search.ieice.org/bin/summary.php?id=e102-b_9_1792</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Auge2018">[Auge2018]</dt>
      <dd>
<span class="refAuthor">Augé, J.</span>, <span class="refAuthor">Carofiglio, G.</span>, <span class="refAuthor">Grassi, G.</span>, <span class="refAuthor">Muscariello, L.</span>, <span class="refAuthor">Pau, G.</span>, and <span class="refAuthor">X. Zeng</span>, <span class="refTitle">"MAP-Me: Managing Anchor-Less Producer Mobility in Content-Centric Networks, in IEEE Transactions on Network, Volume 15, Issue 2"</span>, <span class="seriesInfo">DOI 10.1109/TNSM.2018.2796720</span>, <time datetime="2018-06" class="refDate">June 2018</time>, <span>&lt;<a href="https://ieeexplore.ieee.org/document/8267132">https://ieeexplore.ieee.org/document/8267132</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Baccelli2014">[Baccelli2014]</dt>
      <dd>
<span class="refAuthor">Baccelli, E.</span>, <span class="refAuthor">Mehlis, C.</span>, <span class="refAuthor">Hahm, O.</span>, <span class="refAuthor">Schmidt, T.</span>, and <span class="refAuthor">M. Wählisch</span>, <span class="refTitle">"Information centric networking in the IoT: experiments with NDN in the wild, in ACM-ICN '14: Proceedings of the 1st ACM Conference on Information-Centric Networking"</span>, <span class="seriesInfo">DOI 10.1145/2660129.2660144</span>, <time datetime="2014-09" class="refDate">September 2014</time>, <span>&lt;<a href="https://dl.acm.org/doi/abs/10.1145/2660129.2660144">https://dl.acm.org/doi/abs/10.1145/2660129.2660144</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Carzaniga2011">[Carzaniga2011]</dt>
      <dd>
<span class="refAuthor">Carzaniga, A.</span>, <span class="refAuthor">Papalini, M.</span>, and <span class="refAuthor">A.L. Wolf</span>, <span class="refTitle">"Content-Based Publish/Subscribe Networking and Information-Centric Networking"</span>, <span class="seriesInfo">DOI 10.1145/2018584.2018599</span>, <time datetime="2011-09" class="refDate">September 2011</time>, <span>&lt;<a href="https://conferences.sigcomm.org/sigcomm/2011/papers/icn/p56.pdf">https://conferences.sigcomm.org/sigcomm/2011/papers/icn/p56.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Cefore">[Cefore]</dt>
      <dd>
<span class="refTitle">"Cefore"</span>, <time datetime="2019" class="refDate">2019</time>, <span>&lt;<a href="https://github.com/cefore/">https://github.com/cefore/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Chen2015">[Chen2015]</dt>
      <dd>
<span class="refAuthor">Chen, S.</span>, <span class="refAuthor">Cao, J.</span>, and <span class="refAuthor">L. Zhu</span>, <span class="refTitle">"NDSS: A Named Data Storage System, in International Conference on Cloud and Autonomic Computing"</span>, <span class="seriesInfo">DOI 10.1109/ICCAC.2015.12</span>, <time datetime="2014-09" class="refDate">September 2014</time>, <span>&lt;<a href="https://ieeexplore.ieee.org/document/7312154">https://ieeexplore.ieee.org/document/7312154</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DiBenedettoGTU12">[DiBenedettoGTU12]</dt>
      <dd>
<span class="refAuthor">DiBenedetto, S.</span>, <span class="refAuthor">Gasti, P.</span>, <span class="refAuthor">Tsudik, G.</span>, and <span class="refAuthor">E. Uzun</span>, <span class="refTitle">"ANDaNA: Anonymous Named Data Networking Application, in NDSS 2012"</span>, <span class="seriesInfo">DOI https://arxiv.org/abs/1112.2205v2</span>, <time datetime="2102" class="refDate">2102</time>, <span>&lt;<a href="https://www.ndss-symposium.org/ndss2012/andana-anonymous-named-data-networking-application">https://www.ndss-symposium.org/ndss2012/andana-anonymous-named-data-networking-application</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Gasti2012">[Gasti2012]</dt>
      <dd>
<span class="refAuthor">Gasti, P.</span>, <span class="refAuthor">Tsudik, G.</span>, <span class="refAuthor">Uzun, Ersin.</span>, and <span class="refAuthor">L. Zhang</span>, <span class="refTitle">"DoS and DDoS in Named Data Networking, in 22nd International Conference on Computer Communication and Networks (ICCCN)"</span>, <span class="seriesInfo">DOI 10.1109/ICCCN.2013.6614127</span>, <time datetime="2013-08" class="refDate">August 2013</time>, <span>&lt;<a href="https://ieeexplore.ieee.org/document/6614127">https://ieeexplore.ieee.org/document/6614127</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Ghali2017">[Ghali2017]</dt>
      <dd>
<span class="refAuthor">Tsudik, G.</span>, <span class="refAuthor">Ghali, C.</span>, and <span class="refAuthor">C. Wood</span>, <span class="refTitle">"When encryption is not enough: privacy attacks in content-centric networking, in ICN '17: Proceedings of the 4th ACM Conference on Information-Centric Networking"</span>, <span class="seriesInfo">DOI https://doi.org/10.1145/3125719.3125723</span>, <time datetime="2017-09" class="refDate">September 2017</time>, <span>&lt;<a href="https://dl.acm.org/doi/abs/10.1145/3125719.3125723">https://dl.acm.org/doi/abs/10.1145/3125719.3125723</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Gundogan2018">[Gundogan2018]</dt>
      <dd>
<span class="refAuthor">Gündoğan, C.</span>, <span class="refAuthor">Kietzmann, P.</span>, <span class="refAuthor">Schmidt, T.</span>, and <span class="refAuthor">M. Wählisch</span>, <span class="refTitle">"HoPP: publish-subscribe for the constrained IoT, in ICN '18: Proceedings of the 5th ACM Conference on Information-Centric Networking"</span>, <span class="seriesInfo">DOI 10.1145/3267955.3269020</span>, <time datetime="2018-09" class="refDate">September 2018</time>, <span>&lt;<a href="https://dl.acm.org/doi/abs/10.1145/3267955.3269020">https://dl.acm.org/doi/abs/10.1145/3267955.3269020</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-icnrg-flic">[I-D.irtf-icnrg-flic]</dt>
      <dd>
<span class="refAuthor">Tschudin, C.</span>, <span class="refAuthor">Wood, C. A.</span>, <span class="refAuthor">Mosko, M.</span>, and <span class="refAuthor">D. R. Oran</span>, <span class="refTitle">"File-Like ICN Collections (FLIC)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-icnrg-flic-05</span>, <time datetime="2023-10-22" class="refDate">22 October 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-icnrg-flic-05">https://datatracker.ietf.org/doc/html/draft-irtf-icnrg-flic-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.mosko-icnrg-ccnxchunking">[I-D.mosko-icnrg-ccnxchunking]</dt>
      <dd>
<span class="refAuthor">Mosko, M.</span>, <span class="refTitle">"CCNx Content Object Chunking"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-mosko-icnrg-ccnxchunking-02</span>, <time datetime="2016-06-01" class="refDate">1 June 2016</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-mosko-icnrg-ccnxchunking-02">https://datatracker.ietf.org/doc/html/draft-mosko-icnrg-ccnxchunking-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Krol2018">[Krol2018]</dt>
      <dd>
<span class="refAuthor">Krol, M.</span>, <span class="refAuthor">Habak, K.</span>, <span class="refAuthor">Oran, D.</span>, <span class="refAuthor">Kutscher, D.</span>, and <span class="refAuthor">I. Psaras</span>, <span class="refTitle">"RICE: Remote Method Invocation in ICN, in Proceedings of the 5th ACM Conference on Information-Centric Networking — ICN '18"</span>, <span class="seriesInfo">DOI 10.1145/3267955.3267956</span>, <time datetime="2018-09" class="refDate">September 2018</time>, <span>&lt;<a href="https://conferences.sigcomm.org/acm-icn/2018/proceedings/icn18-final9.pdf">https://conferences.sigcomm.org/acm-icn/2018/proceedings/icn18-final9.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Kutscher2022">[Kutscher2022]</dt>
      <dd>
<span class="refAuthor">Kutscher, D.</span> and <span class="refAuthor">D. Oran</span>, <span class="refTitle">"RESTful information-centric networking: statement, in ICN '22: Proceedings of the 9th ACM Conference on Information-Centric Networking"</span>, <span class="seriesInfo">DOI https://doi.org/10.1145/3517212.3558089</span>, <time datetime="2022-09" class="refDate">September 2022</time>, <span>&lt;<a href="https://dl.acm.org/doi/10.1145/3517212.3558089">https://dl.acm.org/doi/10.1145/3517212.3558089</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Lindgren2016">[Lindgren2016]</dt>
      <dd>
<span class="refAuthor">Lindgren, A.</span>, <span class="refAuthor">Ben Abdessiem, F.</span>, <span class="refAuthor">Ahlgren, B.</span>, <span class="refAuthor">Schlelén, O.</span>, and <span class="refAuthor">A.M. Malik</span>, <span class="refTitle">"Design choices for the IoT in Information-Centric Networks, in 13th IEEE Annual Consumer Communications and Networking Conference (CCNC)"</span>, <span class="seriesInfo">DOI 10.1109/CCNC.2016.7444905</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://ieeexplore.ieee.org/abstract/document/7444905">https://ieeexplore.ieee.org/abstract/document/7444905</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Moiseenko2014">[Moiseenko2014]</dt>
      <dd>
<span class="refAuthor">Moiseenko, I.</span>, <span class="refAuthor">Stapp, M.</span>, and <span class="refAuthor">D. Oran</span>, <span class="refTitle">"Communication patterns for web interaction in named data networking"</span>, <span class="seriesInfo">DOI 10.1145/2660129.2660152</span>, <time datetime="2014-09" class="refDate">September 2014</time>, <span>&lt;<a href="https://dl.acm.org/doi/10.1145/2660129.2660152">https://dl.acm.org/doi/10.1145/2660129.2660152</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Mosko2017">[Mosko2017]</dt>
      <dd>
<span class="refAuthor">Mosko, M.</span>, <span class="refTitle">"CCNx 1.0 Bidirectional Streams"</span>, <span class="seriesInfo">arXiv 1707.04738</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://arxiv.org/abs/1707.04738">https://arxiv.org/abs/1707.04738</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NDN">[NDN]</dt>
      <dd>
<span class="refTitle">"Named Data Networking"</span>, <time datetime="2020" class="refDate">2020</time>, <span>&lt;<a href="https://named-data.net/project/execsummary/">https://named-data.net/project/execsummary/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NDNTLV">[NDNTLV]</dt>
      <dd>
<span class="refTitle">"NDN Packet Format Specification"</span>, <time datetime="2016" class="refDate">2016</time>, <span>&lt;<a href="http://named-data.net/doc/ndn-tlv/">http://named-data.net/doc/ndn-tlv/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3261">[RFC3261]</dt>
      <dd>
<span class="refAuthor">Rosenberg, J.</span>, <span class="refAuthor">Schulzrinne, H.</span>, <span class="refAuthor">Camarillo, G.</span>, <span class="refAuthor">Johnston, A.</span>, <span class="refAuthor">Peterson, J.</span>, <span class="refAuthor">Sparks, R.</span>, <span class="refAuthor">Handley, M.</span>, and <span class="refAuthor">E. Schooler</span>, <span class="refTitle">"SIP: Session Initiation Protocol"</span>, <span class="seriesInfo">RFC 3261</span>, <span class="seriesInfo">DOI 10.17487/RFC3261</span>, <time datetime="2002-06" class="refDate">June 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3261">https://www.rfc-editor.org/info/rfc3261</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6337">[RFC6337]</dt>
      <dd>
<span class="refAuthor">Okumura, S.</span>, <span class="refAuthor">Sawada, T.</span>, and <span class="refAuthor">P. Kyzivat</span>, <span class="refTitle">"Session Initiation Protocol (SIP) Usage of the Offer/Answer Model"</span>, <span class="seriesInfo">RFC 6337</span>, <span class="seriesInfo">DOI 10.17487/RFC6337</span>, <time datetime="2011-08" class="refDate">August 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6337">https://www.rfc-editor.org/info/rfc6337</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7530">[RFC7530]</dt>
      <dd>
<span class="refAuthor">Haynes, T., Ed.</span> and <span class="refAuthor">D. Noveck, Ed.</span>, <span class="refTitle">"Network File System (NFS) Version 4 Protocol"</span>, <span class="seriesInfo">RFC 7530</span>, <span class="seriesInfo">DOI 10.17487/RFC7530</span>, <time datetime="2015-03" class="refDate">March 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7530">https://www.rfc-editor.org/info/rfc7530</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8793">[RFC8793]</dt>
      <dd>
<span class="refAuthor">Wissingh, B.</span>, <span class="refAuthor">Wood, C.</span>, <span class="refAuthor">Afanasyev, A.</span>, <span class="refAuthor">Zhang, L.</span>, <span class="refAuthor">Oran, D.</span>, and <span class="refAuthor">C. Tschudin</span>, <span class="refTitle">"Information-Centric Networking (ICN): Content-Centric Networking (CCNx) and Named Data Networking (NDN) Terminology"</span>, <span class="seriesInfo">RFC 8793</span>, <span class="seriesInfo">DOI 10.17487/RFC8793</span>, <time datetime="2020-06" class="refDate">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8793">https://www.rfc-editor.org/info/rfc8793</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9531">[RFC9531]</dt>
      <dd>
<span class="refAuthor">Moiseenko, I.</span> and <span class="refAuthor">D. Oran</span>, <span class="refTitle">"Path Steering in Content-Centric Networking (CCNx) and Named Data Networking (NDN)"</span>, <span class="seriesInfo">RFC 9531</span>, <span class="seriesInfo">DOI 10.17487/RFC9531</span>, <time datetime="2024-03" class="refDate">March 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9531">https://www.rfc-editor.org/info/rfc9531</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9562">[RFC9562]</dt>
      <dd>
<span class="refAuthor">Davis, K.</span>, <span class="refAuthor">Peabody, B.</span>, and <span class="refAuthor">P. Leach</span>, <span class="refTitle">"Universally Unique IDentifiers (UUIDs)"</span>, <span class="seriesInfo">RFC 9562</span>, <span class="seriesInfo">DOI 10.17487/RFC9562</span>, <time datetime="2024-05" class="refDate">May 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9562">https://www.rfc-editor.org/info/rfc9562</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Shi2020">[Shi2020]</dt>
      <dd>
<span class="refAuthor">Shi, J.</span>, <span class="refAuthor">Pesavento, D.</span>, and <span class="refAuthor">L. Benmohamed</span>, <span class="refTitle">"NDN-DPDK: NDN Forwarding at 100 Gbps on Commodity Hardware, in Proceedings of the 7th ACM Conference on Information-Centric Networking — ICN '20"</span>, <span class="seriesInfo">DOI 10.1145/3405656.3418715</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://dl.acm.org/doi/10.1145/3405656.3418715">https://dl.acm.org/doi/10.1145/3405656.3418715</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="So2013">[So2013]</dt>
      <dd>
<span class="refAuthor">So, W.</span>, <span class="refAuthor">Narayanan, A.</span>, and <span class="refAuthor">D. Oran</span>, <span class="refTitle">"Named data networking on a router: Fast and DoS-resistant forwarding with hash tables, in proceedings of Architectures for Networking and Communications Systems"</span>, <span class="seriesInfo">DOI 10.1109/ANCS.2013.6665203</span>, <time datetime="2013-10" class="refDate">October 2013</time>, <span>&lt;<a href="https://ieeexplore.ieee.org/document/6665203">https://ieeexplore.ieee.org/document/6665203</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Zhang2018">[Zhang2018]</dt>
    <dd>
<span class="refAuthor">Zhang, Y.</span>, <span class="refAuthor">Xia, Z.</span>, <span class="refAuthor">Mastorakis, S.</span>, and <span class="refAuthor">L. Zhang</span>, <span class="refTitle">"KITE: Producer Mobility Support in Named Data Networking, in Proceedings of the 5th ACM Conference on Information-Centric Networking — ICN '18"</span>, <span class="seriesInfo">DOI 10.1145/3267955.3267959</span>, <time datetime="2018-09" class="refDate">September 2018</time>, <span>&lt;<a href="https://conferences.sigcomm.org/acm-icn/2018/proceedings/icn18-final23.pdf">https://conferences.sigcomm.org/acm-icn/2018/proceedings/icn18-final23.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="rejected-alternatives">
<section id="appendix-A">
      <h2 id="name-alternative-designs-conside">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-alternative-designs-conside" class="section-name selfRef">Alternative Designs Considered</a>
      </h2>
<p id="appendix-A-1">During development of this specification, a number of alternative designs were considered and at least partially documented. This appendix explains them for historical purposes, and explains why these were considered inferior to the design we settled on to carry forward.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="fib-based-design">
<section id="appendix-A.1">
        <h3 id="name-handling-reflexive-interest">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-handling-reflexive-interest" class="section-name selfRef">Handling reflexive interests using dynamic FIB entries</a>
        </h3>
<div id="FIB-requirements">
<p id="appendix-A.1-1">
     The original draft specification employed the use of dynamically-created FIB entries for forwarding Reflexive Interests. In this approach,
     at each forwarder along the inverse path from producer to
     consumer, a FIB entry must be present that matches this
     name via Longest Name Prefix Match (LNPM), so that when the reflexive interest
     arrives, the forwarder can forward it downstream toward
     the originating consumer. This FIB entry would point directly
     to the incoming interface on which the corresponding
     original Interest arrived. The FIB entry needs to be
     created as part of the forwarding of the original Interest
     so that it is available in time to catch any reflexive
     Interest issued by the producer. It would usually make sense to
     destroy this FIB entry when the Data message satisfying
     the original Interest arrives since this avoids any
     dangling stale state. Given the design details discussed
     below, stale FIB state would not
     represent a correctness hazard and hence could be done
     lazily if desired in an implementation.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
</div>
<p id="appendix-A.1-2">In this scheme, the forwarder operates as follows:<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-A.1-3">
 <li id="appendix-A.1-3.1">The forwarder creates short-lifetime FIB entries for any
   Reflexive Interest Name prefixes communicated in an Interest
   message. If the forwarder does not have sufficient resources
   to do so, it rejects the Interest with the T_RETURN_NO_RESOURCES error — the same error used if the
   forwarder were lacking sufficient PIT resources to process the Interest message.<a href="#appendix-A.1-3.1" class="pilcrow">¶</a>
</li>
          <li id="appendix-A.1-3.2">Those FIB entries are queried whenever an Interest
   message arrives whose first name segment is of the type
   <em>Reflexive Interest Name Segment (RNP)</em><a href="#appendix-A.1-3.2" class="pilcrow">¶</a>
</li>
          <li id="appendix-A.1-3.3">The FIB entry gets removed eventually, after the
   corresponding Data message has been forwarded. One option
   would be to remove the FIB directly after the Data message
   has been forwarded. However, the forwarder might choose do lazy
   cleanup.<a href="#appendix-A.1-3.3" class="pilcrow">¶</a>
</li>
        </ol>
<p id="appendix-A.1-4">There are a number of additional considerations with this design that need to be dealt with.<a href="#appendix-A.1-4" class="pilcrow">¶</a></p>
<div id="FIB">
<section id="appendix-A.1.1">
          <h4 id="name-design-complexities-and-per">
<a href="#appendix-A.1.1" class="section-number selfRef">A.1.1. </a><a href="#name-design-complexities-and-per" class="section-name selfRef">Design complexities and performance issues with FIB-based design</a>
          </h4>
<p id="appendix-A.1.1-1">When processing an Interest containing the reflexive name TLV and creating the necessary FIB entry, the forwarder also creates a <em>back pointer</em> from that FIB entry to the PIT entry for the Interest message that created it. This PIT entry contains the current value of the remaining Interest lifetime or alternatively a value from which the remaining Interest lifetime can be easily computed. Call this value <em>IL<sub>t</sub></em>.<a href="#appendix-A.1.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1.1-2">The forwarder input thread could key off the high-order name segment type (one byte) and if reflexive,  do a reflexive FIB lookup instead of a full name hash. The reflexive FIB entry would contain the shard identity of the matching Interest (concretely, the core id servicing the shard) and steer the reflexive interest there. The reflexive name prefix FIB lookup would have to be competitive performance-wise with a full-name hash for this to win, however. Experimentation is needed to further evaluate such implementation tradeoffs for input packet load balancing in high-speed forwarders.<a href="#appendix-A.1.1-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1.1-3">The FIB is a performance-critical data structure in any forwarder, as it needs to support relatively expensive longest name prefix match (LNPM) lookup algorithms. A number of well-known FIB data structures are heavily optimized for read access, since for normal Interest message processing the FIB changes slowly — only after topological changes or routing protocol updates. Support for reflexive names using dynamic FIB entries changes this, as FIB entries would be created and destroyed rapidly as Interest messages containing reflexive name TLVs are processed and the corresponding Data messages come back.<a href="#appendix-A.1.1-3" class="pilcrow">¶</a></p>
<p id="appendix-A.1.1-4">While it may be feasible, especially in low-end forwarders handling a low packet forwarding rate to ignore this problem, for high-speed forwarders there are a number of hazards, including:<a href="#appendix-A.1.1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-A.1.1-5">
       <li id="appendix-A.1.1-5.1">If the entire FIB needs to be locked in order to insert or remove entries, this could cause inflated forwarding delays or in extreme cases, forwarding performance collapse.<a href="#appendix-A.1.1-5.1" class="pilcrow">¶</a>
</li>
            <li id="appendix-A.1.1-5.2">A number of high-speed forwarder implementations employ a sharded PIT scheme (see <a href="#PIT-sharding" class="auto internal xref">Section 6.1.1, Paragraph 4</a>) to better parallelize forwarding across processing cores. The FIB, however, is still a shared data structure which is either read without read locks across cores, or explicitly copied such that there is a separate copy of the FIB for each PIT shard. Clearly, a high update rate without read locks and/or updating many copies of the FIB are unattractive implementation options. (Note: unlike the adopted scheme in the main specification, by just depending on a dynamic FIB it is not feasible to force reflexive interests to be hashed or be otherwise directed to the PIT shard holding the original Interest state).<a href="#appendix-A.1.1-5.2" class="pilcrow">¶</a>
</li>
          </ol>
<p id="appendix-A.1.1-6">There are any number of alternative FIB implementations that can work adequately. The most straightforward would be to simply implement a "special" FIB for just reflexive name lookups. This is feasible because reflexive names deterministically contain the distinguished high-order name segment type of T_REFLEXIVE_NAME, whose content is a 64-bit value that can be easily hashed to a FIB entry directly, avoiding the more expensive LNPM lookup. Inserts and deletes then devolve to the well-understood problem of hash table maintenance.<a href="#appendix-A.1.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="FIB-and-interest-lifetime">
<section id="appendix-A.1.2">
          <h4 id="name-interactions-between-fib-ba">
<a href="#appendix-A.1.2" class="section-number selfRef">A.1.2. </a><a href="#name-interactions-between-fib-ba" class="section-name selfRef">Interactions between FIB-based design and Interest Lifetime</a>
          </h4>
<p id="appendix-A.1.2-1">If Interest lifetime handling is implemented naively, it may run afoul of a sharded PIT forwarder implementation, since the PIT entry for the reflexive Interest and the PIT entry for the original Interest may be in different shards. Therefore, if the update is done cross-shard on each reflexive Interest arrival, performance may suffer, perhaps dramatically. Instead, the following approach to updating the Interest lifetime after computing the new value is would be needed by this FIB-based design for sharded-PIT forwarders.<a href="#appendix-A.1.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1.2-2">When creating the  reflexive FIB entry as above in <a href="#FIB" class="auto internal xref">Appendix A.1.1</a>, copy the remaining Interest lifetime from the PIT entry. Do the PIT update if and only if this value is about to expire, thus paying the cross-shard update cost only if the original Interest is about to expire. A further optimization at the cost of modest extra complexity is to instead <em>queue</em> the update to the core holding the shard of the original PIT entry rather than doing the update directly. If the PIT entry expires or is satisfied, instead of removing it the associated core checks the update queue and does the necessary update.<a href="#appendix-A.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="path-steering-based-design">
<section id="appendix-A.2">
        <h3 id="name-reflexive-forwarding-using-">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-reflexive-forwarding-using-" class="section-name selfRef">Reflexive forwarding using Path Steering</a>
        </h3>
<p id="appendix-A.2-1">We also considered leveraging Path Steering <span>[<a href="#RFC9531" class="cite xref">RFC9531</a>]</span> Path
     Labels that inform the forwarder at each hop which
     outgoing face to use for for forwarding the Reflexive
     Interest. In this approach, the producer, when creating and issuing the
     Reflexive Interest with the Reflexive Name Prefix includes
      a Path Label to strictly steer the forwarding at all
     hops from the producer to the consumer (strict mode Path
     Steering). This means, the Reflexive Interest carries the
     Reflexive Name Prefix, but forwarders do not apply LNPM or
     any other outgoing face selection based on the
     name. It also eliminates the need for dynamic FIB entries as discussed above in <a href="#fib-based-design" class="auto internal xref">Appendix A.1</a>.
     Instead the forwarding is strictly steered by the Path Label using regular Path Steering semantics.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-2">The message flow using Path Steering would look like the following:<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
<span id="name-message-flow-overview-using"></span><div id="path-steering-message-flow">
<figure id="figure-7">
          <div class="alignLeft art-ascii-art art-text artwork" id="appendix-A.2-3.1">
<pre>+-----------+                         +-----------+               +-----------+
| Consumer  |                         | Forwarder |               | Producer  |
+-----------+                         +-----------+               +-----------+
      | ------------------------------\     |                           |
      |-| Create I1 with              |     |                           |
      | | additional empty Path Label |     |                           |
      | | data structure for          |     |                           |
      | | reverse discovery           |     |                           |
      | |-----------------------------|     |                           |
      |                                     |                           |
      | I1 with Path Label                  |                           |
      | and RNP TLV                         |                           |
      |------------------------------------&gt;|                           |
      |                                     | -----------------\        |
      |                                     |-| Add path label |        |
      |                                     | | for adjacency  |        |
      |                                     | | to Consumer    |        |
      |                                     | |----------------|        |
      |                                     |                           |
      |                                     | I1                        |
      |                                     |--------------------------&gt;|
      |                                     |       ------------------\ |
      |                                     |       | Create RI state |-|
      |                                     |       |-----------------| |
      |                                     |                           |
      |                                     |               RI with RNP |
      |                                     |            and path label |
      |                                     |             (strict mode) |
      |                                     |&lt;--------------------------|
      |         --------------------------\ |                           |
      |         | perform path label      |-|                           |
      |         | switching (no FIB info) | |                           |
      |         |-------------------------| |                           |
      |                                     |                           |
      |                         RI with RNP |                           |
      |&lt;------------------------------------|                           |
      |                                     |                           |
      | D2 (RNP)                            |                           |
      |------------------------------------&gt;|                           |
      |                                     | --------------------\     |
      |                                     |-| regular PIT-based |     |
      |                                     | | forwarding        |     |
      |                                     | |-------------------|     |
      |                                     |                           |
      |                                     | D2 (RNP)                  |
      |                                     |--------------------------&gt;|
      |                                     |        -----------------\ |
      |                                     |        | all parameters |-|
      |                                     |        | received,      | |
      |                                     |        | answer orig.   | |
      |                                     |        | I1 Interest    | |
      |                                     |        |----------------| |
      |                                     |                           |
      |                                     |                        D1 |
      |                                     |&lt;--------------------------|
      |               --------------------\ |                           |
      |               | regular PIT-based |-|                           |
      |               | forwarding        | |                           |
      |               |-------------------| |                           |
      |                                     |                           |
      |                                  D1 |                           |
      |&lt;------------------------------------|                           |
      |                                     |                           |
</pre>
</div>
<div class="alignLeft art-ascii-art art-text artwork" id="appendix-A.2-3.2">
<pre>
    Legend:
    I1: Interest #1 containing the Reflexive Name Prefix TLV
    RI: Reflexive Interest with Reflexive Name Prefix Segment
    RNP: Reflexive Name Prefix
    D1: Data message, answering initiating I1 Interest
    D2: Data message, answering RI
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-message-flow-overview-using" class="selfRef">Message Flow Overview using Path Steering</a>
          </figcaption></figure>
</div>
<p id="appendix-A.2-4">
 Path Steering uses Path Label data structures on the
 downstream path (from producer to consumer) to discover and
 collect hop-by-hop forwarding information so that consumers
 can then specify selected paths for subsequent
 Interests. Reflexive Forwarding would use the
 same data structure, but for "reverse discovery", i.e., in the
 upstream direction from consumer to producer.<a href="#appendix-A.2-4" class="pilcrow">¶</a></p>
<p id="appendix-A.2-5"> From an operational perspective the path-steering approach does not exhibit good properties with respect to backward compatibility. Without a complete path of forwarders between consumer and producer that support path steering, reflexive interests cannot reach the intended consumer. While we might envision a way to steer a subsequent Interest onto a working path as proposed in <span>[<a href="#RFC9531" class="cite xref">RFC9531</a>]</span>, there is no capability to force Interest routing away from an otherwise working path not supporting the reflexive name TLV.<a href="#appendix-A.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="appendix-B">
      <h2 id="name-ndn-implementation">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-ndn-implementation" class="section-name selfRef">NDN Implementation</a>
      </h2>
<p id="appendix-B-1">
   An implementation of Reflexive Forwarind in NDN is available at
   https://github.com/nflsjxc/Reflexive-Forwarding-NDN-demo/tree/master. It
   differs from this specification in the following ways:<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<section id="appendix-B.1">
        <h3 id="name-reflexive-name-segment-2">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-reflexive-name-segment-2" class="section-name selfRef">Reflexive Name Segment</a>
        </h3>
<p id="appendix-B.1-1">
   Currently Reflexive Name Component is the suffix instead of the
   prefix for the Reflexive Names. This is easier for prefix matching
   in NFD.<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-B.2">
        <h3 id="name-processing-reflexive-intere">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-processing-reflexive-intere" class="section-name selfRef">Processing Reflexive Interests&gt;</a>
        </h3>
<p id="appendix-B.2-1">
   Currently we omit the RNP checking of Reflexive Interest with RNP
   in PIT entry because NFD now uses name-based PITs.<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2-2">
   Generally speaking there are 2 types of interests in the message flow:<a href="#appendix-B.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-B.2-3">
     <li id="appendix-B.2-3.1">Reflexive Interest (Consumer -&gt; Producer)<a href="#appendix-B.2-3.1" class="pilcrow">¶</a>
</li>
          <li id="appendix-B.2-3.2">Reflexive Interest (Producer -&gt; Consumer)<a href="#appendix-B.2-3.2" class="pilcrow">¶</a>
</li>
        </ol>
<p id="appendix-B.2-4">
     Currently the two types of Interests are identified by the
     Reflexive Name value, if RN=9999, then it is the Reflexive Interest
     from Producer to Consumer.<a href="#appendix-B.2-4" class="pilcrow">¶</a></p>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dave Oran</span></div>
<div dir="auto" class="left"><span class="org">Network Systems Research and Design</span></div>
<div dir="auto" class="left"><span class="street-address">4 Shady Hill Square</span></div>
<div dir="auto" class="left">
<span class="locality">Cambridge</span>, <span class="region">MA</span> <span class="postal-code">02138</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:daveoran@orandom.net" class="email">daveoran@orandom.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dirk Kutscher</span></div>
<div dir="auto" class="left"><span class="org">HKUST(GZ)</span></div>
<div dir="auto" class="left"><span class="locality">Guangzhou</span></div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ietf@dkutscher.net" class="email">ietf@dkutscher.net</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://dirk-kutscher.info" class="url">https://dirk-kutscher.info</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hitoshi Asaeda</span></div>
<div dir="auto" class="left"><span class="org">National Institute of Information and Communications Technology</span></div>
<div dir="auto" class="left">
<span class="street-address">4-2-1 Nukui-Kitamachi</span>, <span class="region">Tokyo</span>
</div>
<div dir="auto" class="left"><span class="postal-code">184-8795</span></div>
<div dir="auto" class="left"><span class="country-name">Japan</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:asaeda@nict.go.jp" class="email">asaeda@nict.go.jp</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
